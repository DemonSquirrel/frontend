(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{Q0Xt:function(t,e,n){"use strict";n.d(e,"a",function(){return Qt});var i=n("quSY"),s=n("PqYM"),a=n("itXk"),o=n("UETp"),c=n("fXoL"),r=n("yTNM"),l=n("0IaG"),u=n("gbi4"),h=n("sYmb"),d=n("Avyq"),m=n("tyNb"),b=n("l7P3"),g=n("s65G"),p=n("RtGS"),f=n("ofXK"),x=n("nzN9"),v=n("hZBc"),w=n("k3bj"),_=n("NFeN"),y=n("wZkO"),O=n("IU+r"),P=n("Qu3c"),k=n("gaSO");function D(t,e){if(1&t&&(c.Vb(0,"div",7),c.Vb(1,"div",3),c.Qb(2,"azt-create-avatar",8),c.Ub(),c.Ub()),2&t){const t=c.gc();c.nc("ngStyle",t.avatarStyle),c.Db(2),c.oc("matTooltip",t.returnTooltip()),c.nc("nameCreateAvatar",t.studentObj.fullName)("size",80)("linkAvatar",t.studentObj.avatar)}}function C(t,e){if(1&t&&(c.Vb(0,"p",9),c.Rc(1),c.hc(2,"date"),c.Ub()),2&t){const t=c.gc();c.Db(1),c.Tc("Ng\xe0y sinh: ",c.jc(2,1,t.birthDay,"dd/MM/yyyy"),"")}}function I(t,e){if(1&t&&(c.Vb(0,"p",10),c.Rc(1),c.hc(2,"anonymousPhone"),c.Ub()),2&t){const t=c.gc();c.Db(1),c.Tc("\u0110i\u1ec7n tho\u1ea1i: ",c.ic(2,1,t.phone),"")}}const M=["*"];let q=(()=>{class t{constructor(t,e,n,i,s){this.activeRoute=t,this.router=e,this.commonService=n,this.localize=i,this.apiService=s,this.avatarUrl="http://stume.net:8082/azota/images/home/u64.png",this.name="",this.birthDay="",this.phone="",this.showAvatar=!0,this.containerStyle={},this.studentObj={},this.borderStyle={padding:"0px",border:"none"},this.flexStyle={"flex-direction":"row"},this.avatarStyle={}}returnTooltip(){return null==this.studentObj.parentPhone?"ID: "+this.studentObj.parentId+" - Phone: "+this.commonService.anonymousPhone(this.studentObj.phone):"ID: "+this.studentObj.parentId+" - Phone: "+this.commonService.anonymousPhone(this.studentObj.parentPhone)+" - Name: "+this.studentObj.parentFullName}ngOnInit(){this.containerStyle=Object.assign(Object.assign({},this.borderStyle),this.flexStyle)}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(m.a),c.Pb(m.i),c.Pb(u.a),c.Pb(d.e),c.Pb(r.a))},t.\u0275cmp=c.Jb({type:t,selectors:[["azt-basic-info-box"]],inputs:{avatarUrl:"avatarUrl",name:"name",birthDay:"birthDay",phone:"phone",showAvatar:"showAvatar",containerStyle:"containerStyle",studentObj:"studentObj",borderStyle:"borderStyle",flexStyle:"flexStyle",avatarStyle:"avatarStyle"},ngContentSelectors:M,decls:9,vars:5,consts:[[1,"azt_container",3,"ngStyle"],["class","avatar azt_item",3,"ngStyle",4,"ngIf"],[1,"info_text","azt_item"],[1,"wrap-content"],[1,"info_text-item","bold"],["class","info_text-item",4,"ngIf"],["class","info_text-item truncate",4,"ngIf"],[1,"avatar","azt_item",3,"ngStyle"],[2,"cursor","pointer",3,"nameCreateAvatar","matTooltip","size","linkAvatar"],[1,"info_text-item"],[1,"info_text-item","truncate"]],template:function(t,e){1&t&&(c.mc(),c.Vb(0,"div",0),c.Pc(1,D,3,5,"div",1),c.Vb(2,"div",2),c.Vb(3,"div",3),c.Vb(4,"p",4),c.Rc(5),c.Ub(),c.Pc(6,C,3,4,"p",5),c.Pc(7,I,3,3,"p",6),c.lc(8),c.Ub(),c.Ub(),c.Ub()),2&t&&(c.nc("ngStyle",e.containerStyle),c.Db(1),c.nc("ngIf",e.showAvatar),c.Db(4),c.Sc(e.name),c.Db(1),c.nc("ngIf",e.birthDay),c.Db(1),c.nc("ngIf",e.phone))},directives:[f.n,f.m,O.a,P.a],pipes:[f.e,k.b],styles:[".azt_container[_ngcontent-%COMP%]{display:flex;align-items:center}.azt_container[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:80px;margin-right:10px}.azt_container[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   .wrap-content[_ngcontent-%COMP%]{width:100%;height:80px;border-radius:50%;overflow:hidden}.azt_container[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   .wrap-content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%}.azt_container[_ngcontent-%COMP%]   .info_text[_ngcontent-%COMP%]{flex:auto;overflow:hidden}.azt_container[_ngcontent-%COMP%]   .info_text[_ngcontent-%COMP%]   .info_text-item[_ngcontent-%COMP%]{margin-bottom:0}.azt_container[_ngcontent-%COMP%]   .info_text[_ngcontent-%COMP%]   .info_text-item.bold[_ngcontent-%COMP%]{font-weight:500}.azt_container[_ngcontent-%COMP%]   .info_text[_ngcontent-%COMP%]   .info_text-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}"]}),t})();var S=n("kmnG"),j=n("d3UM"),R=n("3Pt+"),T=n("FKr1"),U=n("Vwpm"),L=n("gJ4n"),E=n("AytR");function A(t,e){if(1&t){const t=c.Wb();c.Vb(0,"div",10),c.Vb(1,"mat-icon",11),c.cc("click",function(n){c.Dc(t);const i=e.index;return c.gc().toggleVisibility(n,i)}),c.Rc(2,"visibility"),c.Ub(),c.Vb(3,"span",12),c.Rc(4),c.Vb(5,"span",13),c.Rc(6),c.Ub(),c.Ub(),c.Vb(7,"input",14),c.cc("keyup",function(n){c.Dc(t);const i=e.$implicit;return c.gc().validateForm(n,i.essMaxPoint)}),c.Ub(),c.Ub()}if(2&t){const t=e.$implicit,n=e.index,i=c.gc();c.Db(4),c.Tc("C\xe2u ",t.indexLabel+1," "),c.Db(2),c.Tc("(",t.essMaxPoint," \u0111i\u1ec3m)"),c.Db(1),c.pc("formControlName","cau",n,""),c.nc("readonly",!i.isBackEnd)("max",t.essMaxPoint)}}function V(t,e){if(1&t){const t=c.Wb();c.Vb(0,"div",15),c.Vb(1,"button",16),c.cc("click",function(){return c.Dc(t),c.gc().getMnoteJsonData()}),c.Rc(2),c.Ub(),c.Ub()}if(2&t){const t=c.gc();c.Db(1),c.nc("disabled",t.isLoading),c.Db(1),c.Sc(t.isLoading?"\u0110ang l\u01b0u...":"L\u01b0u \u0111i\u1ec3m")}}function B(t,e){if(1&t){const t=c.Wb();c.Vb(0,"div",21),c.Vb(1,"form",22),c.Vb(2,"label",23),c.Rc(3),c.Vb(4,"span",13),c.Rc(5),c.Ub(),c.Rc(6,":"),c.Ub(),c.Vb(7,"input",24),c.cc("keyup",function(e){c.Dc(t);const n=c.gc().$implicit;return c.gc().validateForm(e,n.essMaxPoint)}),c.Ub(),c.Ub(),c.Ub()}if(2&t){const t=c.gc(),e=t.index,n=t.$implicit,i=c.gc();c.Db(1),c.nc("formGroup",i.form),c.Db(1),c.oc("for","cau_"+e),c.Db(1),c.Tc("Nh\u1eadp \u0111i\u1ec3m c\xe2u ",n.indexLabel+1," "),c.Db(2),c.Tc("(",n.essMaxPoint," \u0111i\u1ec3m)"),c.Db(2),c.pc("formControlName","cau",e,""),c.nc("readonly",!i.isBackEnd)("id","cau_"+e)("max",n.essMaxPoint)}}function Q(t,e){if(1&t&&(c.Vb(0,"div",17),c.Vb(1,"div",18),c.Qb(2,"azt-question-item",19),c.Pc(3,B,8,8,"div",20),c.Ub(),c.Ub()),2&t){const t=e.$implicit,n=e.index,i=c.gc();c.Db(1),c.pc("id","q_",n,""),c.Db(1),c.nc("isBackEnd",i.isBackEnd)("examObj",i.examObj)("question",t)("index",t.indexLabel)("configExam",i.configExam)("userAnswersObj",i.userAnswersObj)("place","essay"),c.Db(1),c.nc("ngIf",i.isBackEnd)}}function z(t,e){1&t&&(c.Vb(0,"div",25),c.Vb(1,"b"),c.Rc(2,"\u1ea2nh b\xe0i l\xe0m t\u1ef1 lu\u1eadn: "),c.Ub(),c.Rc(3,"Kh\xf4ng c\xf3 d\u1eef li\u1ec7u \u1ea3nh b\xe0i l\xe0m t\u1ef1 lu\u1eadn c\u1ee7a th\xed sinh."),c.Ub())}function F(t,e){if(1&t){const t=c.Wb();c.Vb(0,"div",26),c.Vb(1,"button",27),c.cc("click",function(){return c.Dc(t),c.gc().getMnoteJsonData()}),c.Rc(2),c.Ub(),c.Ub()}if(2&t){const t=c.gc();c.Db(1),c.nc("disabled",t.isLoading),c.Db(1),c.Sc(t.isLoading?"\u0110ang l\u01b0u...":"L\u01b0u \u0111i\u1ec3m")}}const N=function(t){return{display:t}};let W=(()=>{class t{constructor(t,e,n){this.apiService=t,this.fb=e,this.commonService=n,this.isBackEnd=!0,this.resultID=0,this.files=[],this.questions=[],this.userAnswersObj={},this.examResultObj={},this.iframeSrc="",this.examQuestionObjs=[],this.configExam={},this.examObj={},this.saveResultEvent=new c.o,this.totalMaxPoint=0,this.form=new R.k({}),this.maxPointPerQuestion=[],this.subscriptions=new i.a,this.isLoading=!1,this.jsonData={},this.mnoteJsonData={},this.pagesCount=0,this.handleIframe=t=>{if("MNoteJson"==t.data.cmd&&(this.isLoading=!0,this.mnoteJsonData=t.data.data,this.uploadAll(this.mnoteJsonData.pages)),"MNoteLoadComplete"==t.data){const t=document.getElementById("mNote").contentWindow;if(null!==t)if(this.examResultObj.confirmedAt){if(this.examResultObj.result){var e=this.commonService.parseJson(this.examResultObj.result);if(null!=e){for(let t=0;t<e.pages.length;t++)e.pages[t].backgroundImage&&(e.pages[t].backgroundImage=this.commonService.getMyCdn(e.pages[t].backgroundImage)),e.pages[t].draw&&(e.pages[t].draw=this.commonService.getMyCdn(e.pages[t].draw));e=JSON.stringify(e),this.examResultObj.result=e}}if(this.jsonData=this.commonService.parseJson(this.examResultObj.result),this.jsonData&&this.jsonData.hasOwnProperty("pages"))for(let t=0;t<this.jsonData.pages.length;t++)this.jsonData.pages[t].hasOwnProperty("backgroundImage")&&(this.jsonData.pages[t].backgroundImage=this.commonService.getMyCdn(this.jsonData.pages[t].backgroundImage)),this.jsonData.pages[t].hasOwnProperty("draw")&&(this.jsonData.pages[t].draw=this.commonService.getMyCdn(this.jsonData.pages[t].draw));this.jsonData.cmd="initMNote",this.jsonData.mode="edit",this.jsonData.context="exam",t.postMessage(this.jsonData,"*")}else{let e=[];this.files.forEach(t=>{e.push({backgroundImage:this.commonService.getMyCdn(t.url)})}),t.postMessage({cmd:"initMNote",pages:e,mode:"edit",context:"exam"},"*")}}}}uploadBase64ToCDN(t,e){var n=this.apiService.dataURItoBlob(t),i=E.a.base_upload_api+"get_public_upload_url_for_mark";i+="?file_name="+encodeURIComponent(`essay_note_${e}_${this.resultID}.png`),i+="&file_size="+encodeURIComponent("10000"),i+="&minetype="+encodeURIComponent("image/png");const s={Authorization:"Bearer "+this.apiService.getToken()};this.apiService.commonHttp(i,s,!1).subscribe(t=>{if(1!=t.success)throw"L\u01b0u d\u1eef li\u1ec7u ch\u1ea5m b\xe0i kh\xf4ng th\xe0nh c\xf4ng!";var i=t.data.url;this.apiService.commonPutHttp(t.data.upload_url,{"Content-Type":"image/png","x-amz-acl":"public-read"},n).subscribe(t=>{if(t&&t.success&&0==t.success)throw"L\u01b0u d\u1eef li\u1ec7u ch\u1ea5m b\xe0i kh\xf4ng th\xe0nh c\xf4ng!";this.mnoteJsonData.pages[e].draw=i,this.pagesCount--,0==this.pagesCount&&this.remark(JSON.stringify(this.mnoteJsonData))})})}parseValue(t){return this.commonService.parseJson(this.examResultObj.essayResult)[t]}uploadAll(t){this.pagesCount=0;for(let e=0;e<t.length;e++)t[e].draw&&this.pagesCount++;if(0==this.pagesCount)this.remark(JSON.stringify(this.mnoteJsonData));else for(let e=0;e<t.length;e++)t[e].draw&&this.uploadBase64ToCDN(t[e].draw,e)}getMaxPoint(t){var e=0;for(let n=0;n<this.examQuestionObjs.length;n++)if(this.examQuestionObjs[n].questionId==t){e=this.commonService.parseJson(this.examQuestionObjs[n].config).ScorePerQuestion;break}return e}remark(t){var e=0;for(const n in this.form.value)e+=""!=this.form.value[n]&&this.form.value[n]?parseFloat(this.form.value[n]):0;this.apiService.saveEssayMark(this.resultID,e,t,JSON.stringify(this.form.value)).subscribe(t=>{1==t.success?(this.commonService.snackSuccess("Ch\u1ea5m \u0111i\u1ec3m t\u1ef1 lu\u1eadn th\xe0nh c\xf4ng",""),this.saveResultEvent.emit(1),this.isLoading=!1):(this.commonService.myTranslate([t.message]).subscribe(e=>{this.commonService.snackError("Ch\u1ea5m \u0111i\u1ec3m t\u1ef1 lu\u1eadn kh\xf4ng th\xe0nh c\xf4ng: "+e[t.message],"")}),this.saveResultEvent.emit(0),this.isLoading=!1)})}getMnoteJsonData(){if(this.commonService.hasMarkPointPermission("exam",this.examObj.permissionObj)||this.commonService.hasConfigAndMarkClassroomPermission("exam",this.examObj.permissionObj)){if(!this.isValidPoint())return void this.commonService.snackError("Ch\u1ea5m \u0111i\u1ec3m v\u01b0\u1ee3t qu\xe1 s\u1ed1 \u0111i\u1ec3m t\u1ed1i \u0111a, vui l\xf2ng ki\u1ec3m tra l\u1ea1i","");if(this.files&&this.files.length>0){const t=document.getElementById("mNote").contentWindow;null!==t&&t.postMessage({cmd:"getMNoteJson"},"*")}else this.isLoading=!0,this.remark("")}else this.commonService.snackError("B\u1ea1n kh\xf4ng c\xf3 quy\u1ec1n ch\u1ea5m \u0111\u1ec1 thi n\xe0y!","")}toggleVisibility(t,e){var n=t.target,i=document.getElementById("q_"+e);i&&("block"==(null==i?void 0:i.style.display)?(i.style.display="none",n&&(n.textContent="visibility_off")):(i.style.display="block",n&&(n.textContent="visibility")))}isValidPoint(){let t=0;var e=this.form.value;for(var n in e){var i=Number(n.substring(3));e[n]>this.maxPointPerQuestion[i]&&t++}return!(t>0)}validateForm(t,e){let n=parseFloat(t.target.value);n>e&&this.commonService.snackError("B\u1ea1n \u0111ang nh\u1eadp \u0111i\u1ec3m qu\xe1 s\u1ed1 \u0111i\u1ec3m t\u1ed1i \u0111a c\u1ee7a c\xe2u h\u1ecfi",""),n<0&&this.commonService.snackError("B\u1ea1n \u0111ang nh\u1eadp nh\u1ecf h\u01a1n 0","")}ngOnInit(){this.iframeSrc=this.commonService.getEnvValue("classliveUrl");var t={};let e;this.examResultObj.confirmedAt&&(e=this.commonService.parseJson(this.examResultObj.essayResult));for(let i=0;i<this.questions.length;i++){var n="cau"+i;t[n]=new R.h(e?e[n]:"0")}this.form=this.fb.group(t),this.questions.forEach(t=>{let e=this.getMaxPoint(t.id);this.totalMaxPoint+=e,t.essMaxPoint=e,this.maxPointPerQuestion.push(t.essMaxPoint)}),this.form.valueChanges.subscribe(t=>{let e=JSON.stringify(t);e!=this.prevData&&(this.prevData=e,this.form.patchValue(t))})}ngOnChanges(){}ngAfterViewInit(){window.addEventListener("message",this.handleIframe)}ngOnDestroy(){this.subscriptions.unsubscribe(),window.removeEventListener("message",this.handleIframe)}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(r.a),c.Pb(R.g),c.Pb(u.a))},t.\u0275cmp=c.Jb({type:t,selectors:[["azt-mark-essay"]],inputs:{isBackEnd:"isBackEnd",resultID:"resultID",files:"files",questions:"questions",userAnswersObj:"userAnswersObj",examResultObj:"examResultObj",iframeSrc:"iframeSrc",examQuestionObjs:"examQuestionObjs",configExam:"configExam",examObj:"examObj"},outputs:{saveResultEvent:"saveResultEvent"},features:[c.Bb],decls:11,vars:12,consts:[["id","essayBoxButtons"],[1,"listSTT",3,"formGroup"],["class","col-wrap",4,"ngFor","ngForOf"],["class","BWrap-one",4,"ngIf"],["id","showQuestionEssay"],["class","essay_qItem",4,"ngFor","ngForOf"],["class","mb-2 mt-2",4,"ngIf"],[1,"card-box","listPhotos",3,"ngStyle"],["id","mNote","frameborder","0",2,"width","100%","height","100%",3,"src"],["class","BWrap",4,"ngIf"],[1,"col-wrap"],["matTooltip","\u1ea8n/Hi\u1ec7n ph\u1ea7n b\xe0i l\xe0m c\u1ee7a c\xe2u h\u1ecfi n\xe0y",3,"click"],[1,"stt",2,"width","105px"],["matTooltip","\u0110i\u1ec3m t\u1ed1i \u0111a cho c\xe2u h\u1ecfi n\xe0y (theo thang \u0111i\u1ec3m)",1,"maxPoint"],["type","number","min","0","placeholder","Nh\u1eadp \u0111i\u1ec3m",3,"readonly","max","formControlName","keyup"],[1,"BWrap-one"],["id","btn-1",1,"mt-3","btn","btn-primary",3,"disabled","click"],[1,"essay_qItem"],[1,"mt-2",2,"display","block",3,"id"],[3,"isBackEnd","examObj","question","index","configExam","userAnswersObj","place"],["class","block-input",4,"ngIf"],[1,"block-input"],[1,"form-mark",3,"formGroup"],[3,"for"],["min","0","type","number","placeholder","Nh\u1eadp \u0111i\u1ec3m",1,"form-input",3,"readonly","id","max","formControlName","keyup"],[1,"mb-2","mt-2"],[1,"BWrap"],["id","btn-2",1,"mt-3","btn","btn-primary",3,"disabled","click"]],template:function(t,e){1&t&&(c.Vb(0,"div",0),c.Vb(1,"form",1),c.Pc(2,A,8,5,"div",2),c.Ub(),c.Pc(3,V,3,2,"div",3),c.Ub(),c.Vb(4,"div",4),c.Pc(5,Q,4,9,"div",5),c.Ub(),c.Pc(6,z,4,0,"div",6),c.Vb(7,"div",7),c.Qb(8,"iframe",8),c.hc(9,"safe"),c.Ub(),c.Pc(10,F,3,2,"div",9)),2&t&&(c.Db(1),c.nc("formGroup",e.form),c.Db(1),c.nc("ngForOf",e.questions),c.Db(1),c.nc("ngIf",e.isBackEnd),c.Db(2),c.nc("ngForOf",e.questions),c.Db(1),c.nc("ngIf",e.files&&0==e.files.length),c.Db(1),c.nc("ngStyle",c.sc(10,N,e.files&&0==e.files.length?"none":"block")),c.Db(1),c.nc("src",c.ic(9,8,e.iframeSrc),c.Fc),c.Db(2),c.nc("ngIf",e.isBackEnd))},directives:[R.B,R.s,R.l,f.l,f.m,f.n,_.a,P.a,R.w,R.d,R.r,R.j,L.a],pipes:[k.r],styles:["#essayBoxButtons[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;background:#fff;padding:10px;border:1px solid #f1f1f1}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]{flex:auto;display:flex;flex-wrap:wrap;padding-bottom:10px;width:100%;border-bottom:1px solid #f1f1f1}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{margin-right:5px;display:flex;justify-content:center;align-items:center;padding-right:5px;border-right:1px solid #f1f1f1;margin-bottom:5px;width:19.5%}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin:0 5px;border:1px solid #ccc;height:30px;border-radius:3px;padding-left:5px;width:60px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], #essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{margin-right:3px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   .maxPoint[_ngcontent-%COMP%]{color:#838383;margin-right:3px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   .maxPoint[_ngcontent-%COMP%]:hover{cursor:help}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#585858}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]:hover{cursor:pointer}.btn-primary[_ngcontent-%COMP%]{transition:all .5s;display:inline-block;background:#3f51b5;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);font-family:Roboto,Helvetica Neue,sans-serif;font-size:14px;font-weight:500}.btn-primary[_ngcontent-%COMP%]:hover{background:#0e2399}.form-input[_ngcontent-%COMP%]{margin:0 5px;border:1px solid #ccc;height:30px;border-radius:3px;padding-left:5px;width:60px}.form-mark[_ngcontent-%COMP%]{margin-left:20px}div#showQuestionEssay[_ngcontent-%COMP%]{background-color:#fff;width:100%}.BWrap[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;padding-bottom:15px}.essay_qItem[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:30px 30px 0}.essay_qItem[_ngcontent-%COMP%]:last-child > div[_ngcontent-%COMP%]{margin-bottom:1rem;padding-bottom:30px!important}@media screen and (max-width:1474px){#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{margin-bottom:5px}.stt[_ngcontent-%COMP%]{font-size:12px}.maxPoint[_ngcontent-%COMP%]{font-size:10px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{width:19.4%}}@media screen and (max-width:768px){.stt[_ngcontent-%COMP%]{font-size:13px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{width:48%}}@media screen and (max-width:480px){#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{border-right:none;margin-bottom:5px}.stt[_ngcontent-%COMP%]{font-size:13px}#essayBoxButtons[_ngcontent-%COMP%]   .listSTT[_ngcontent-%COMP%]   .col-wrap[_ngcontent-%COMP%]{width:99%}}"]}),t})();function J(t,e){1&t&&c.Qb(0,"azt-loading-effect")}function H(t,e){if(1&t&&c.Qb(0,"header-backend",7),2&t){const t=c.gc(2);c.nc("headerTitle",t.headerTitle)("back_link",t.back_link)}}function $(t,e){if(1&t){const t=c.Wb();c.Vb(0,"header-frontend",8),c.cc("RedirectToLink",function(){return c.Dc(t),c.gc(2).redirectToBackLink()}),c.Ub()}if(2&t){const t=c.gc(2);c.nc("headerTitle",t.headerTitle)("checkUrlFunction",!0)}}function G(t,e){if(1&t&&c.Qb(0,"azt-basic-info-box",31),2&t){const t=c.gc(5);c.nc("name",t.studentObj.fullName)("avatarUrl",t.studentObj.avatar?t.studentObj.avatar:"https://ui-avatars.com/api/?uppercase=false&color=fff&background=a9a9a9&name="+t.studentObj.fullName)("birthDay",t.studentObj.birthday?t.studentObj.birthday:null)("phone",t.studentObj.phone?t.studentObj.phone:null)("studentObj",t.studentObj)}}function K(t,e){1&t&&(c.Vb(0,"div"),c.Vb(1,"div",32),c.Rc(2," Th\xed sinh ch\u01b0a thi l\u1ea7n n\xe0o. "),c.Ub(),c.Ub())}function X(t,e){if(1&t&&(c.Vb(0,"span",41),c.Rc(1),c.Ub()),2&t){const t=c.gc(7);c.Db(1),c.Sc(t.examResultObj.mark)}}function Y(t,e){1&t&&(c.Vb(0,"span",41),c.Rc(1,"Ch\u01b0a \u0111\u01b0\u1ee3c xem"),c.Ub())}function Z(t,e){if(1&t){const t=c.Wb();c.Vb(0,"mat-icon",42),c.cc("click",function(){return c.Dc(t),c.gc(7).clickExportPdf()}),c.Rc(1,"file_download"),c.Ub()}}function tt(t,e){if(1&t&&(c.Vb(0,"li"),c.Rc(1),c.Ub()),2&t){const t=c.gc(7);c.Db(1),c.Vc(" Tr\u1eafc nghi\u1ec7m: ",t.examResultObj.trueFalseMark," (",t.examResultObj.rightAnswer,"/",t.examResultObj.totalQuestion-t.countEssayQuestion,") ")}}function et(t,e){if(1&t&&(c.Vb(0,"li"),c.Rc(1),c.Ub()),2&t){const t=c.gc(7);c.Db(1),c.Uc(" T\u1ef1 lu\u1eadn: ",t.examResultObj.confirmedAt?t.examResultObj.essayMark:"Ch\u01b0a ch\u1ea5m"," (",t.countEssayQuestion," c\xe2u) ")}}function nt(t,e){1&t&&(c.Vb(0,"li"),c.Rc(1,"Tr\u1eafc nghi\u1ec7m: Ch\u01b0a \u0111\u01b0\u1ee3c xem"),c.Ub())}function it(t,e){1&t&&(c.Vb(0,"li"),c.Rc(1,"T\u1ef1 lu\u1eadn: Ch\u01b0a \u0111\u01b0\u1ee3c xem"),c.Ub())}function st(t,e){if(1&t&&(c.Vb(0,"li"),c.Rc(1),c.Ub(),c.Vb(2,"li"),c.Rc(3),c.Ub()),2&t){const t=c.gc(7);c.Db(1),c.Tc("S\u1ed1 l\u1ea7n tho\xe1t m\xe0n h\xecnh: ",t.examTracks.exitCount,""),c.Db(2),c.Tc("S\u1ed1 l\u1ea7n tho\xe1t tr\xecnh duy\u1ec7t: ",t.examTracks.blurCount,"")}}const at=function(t){return{"margin-top":t}};function ot(t,e){if(1&t&&(c.Vb(0,"div"),c.Vb(1,"div",35),c.Vb(2,"span"),c.Rc(3,"\u0110i\u1ec3m cu\u1ed1i"),c.Ub(),c.Pc(4,X,2,1,"span",36),c.Pc(5,Y,2,0,"span",36),c.Ub(),c.Vb(6,"div",37),c.Vb(7,"div",38),c.Vb(8,"span"),c.Rc(9,"Th\xf4ng tin chi ti\u1ebft"),c.Ub(),c.Pc(10,Z,2,0,"mat-icon",39),c.Ub(),c.Vb(11,"ul"),c.Pc(12,tt,2,3,"li",33),c.Pc(13,et,2,2,"li",33),c.Pc(14,nt,2,0,"li",33),c.Pc(15,it,2,0,"li",33),c.Pc(16,st,4,2,"ng-template",40),c.Ub(),c.Ub(),c.Ub()),2&t){const t=c.gc(6);c.Db(1),c.nc("ngStyle",c.sc(9,at,t.isBackEnd?"15px":"0px")),c.Db(3),c.nc("ngIf",2!=t.examConfig.whenShowResult),c.Db(1),c.nc("ngIf",2==t.examConfig.whenShowResult),c.Db(5),c.nc("ngIf",t.isBackEnd),c.Db(2),c.nc("ngIf",t.multipleChoiceList.length>0&&2!=t.examConfig.whenShowResult),c.Db(1),c.nc("ngIf",t.essayQuestionList.length>0&&2!=t.examConfig.whenShowResult),c.Db(1),c.nc("ngIf",t.multipleChoiceList.length>0&&2==t.examConfig.whenShowResult),c.Db(1),c.nc("ngIf",t.essayQuestionList.length>0&&2==t.examConfig.whenShowResult),c.Db(1),c.nc("ngIf",t.examTracks&&1==t.examObj.autoMonitor)}}function ct(t,e){if(1&t){const t=c.Wb();c.Vb(0,"mat-icon",45),c.cc("click",function(){return c.Dc(t),c.gc(7).clickExportPdf()}),c.Rc(1,"file_download"),c.Ub()}}function rt(t,e){if(1&t){const t=c.Wb();c.Vb(0,"mat-icon",48),c.cc("click",function(){return c.Dc(t),c.gc(8).clickResultTrack()}),c.Rc(1,"view_timeline"),c.Ub()}}function lt(t,e){if(1&t&&(c.Vb(0,"li",46),c.Rc(1),c.Pc(2,rt,2,0,"mat-icon",47),c.Ub()),2&t){const t=c.gc(7);c.Db(1),c.Vc(" Tr\u1eafc nghi\u1ec7m: ",t.examResultObj.trueFalseMark," (",t.examResultObj.rightAnswer,"/",t.examResultObj.totalQuestion-t.countEssayQuestion,") "),c.Db(1),c.nc("ngIf",t.checkHasType1Question)}}function ut(t,e){if(1&t&&(c.Vb(0,"span"),c.Qb(1,"azt-create-avatar",49),c.Ub()),2&t){const t=c.gc(8);c.Db(1),c.oc("matTooltip","Ng\u01b0\u1eddi ch\u1ea5m: "+t.markedByObj.fullName),c.nc("nameCreateAvatar",t.markedByObj.fullName)("size",25)("linkAvatar",t.markedByObj.avatar)}}function ht(t,e){if(1&t&&(c.Vb(0,"li"),c.Rc(1),c.Pc(2,ut,2,4,"span",33),c.Ub()),2&t){const t=c.gc(7);c.Db(1),c.Uc(" T\u1ef1 lu\u1eadn: ",t.examResultObj.confirmedAt?t.examResultObj.essayMark:"Ch\u01b0a ch\u1ea5m"," (",t.countEssayQuestion," c\xe2u) "),c.Db(1),c.nc("ngIf",t.examResultObj.confirmedAt)}}function dt(t,e){if(1&t&&(c.Vb(0,"li"),c.Rc(1),c.Ub(),c.Vb(2,"li"),c.Rc(3),c.Ub()),2&t){const t=c.gc(7);c.Db(1),c.Tc("S\u1ed1 l\u1ea7n tho\xe1t m\xe0n h\xecnh: ",t.examTracks.exitCount,""),c.Db(2),c.Tc("S\u1ed1 l\u1ea7n tho\xe1t tr\xecnh duy\u1ec7t: ",t.examTracks.blurCount,"")}}function mt(t,e){if(1&t&&(c.Vb(0,"div"),c.Vb(1,"div",35),c.Vb(2,"span"),c.Rc(3,"\u0110i\u1ec3m cu\u1ed1i"),c.Ub(),c.Vb(4,"span",41),c.Rc(5),c.Ub(),c.Ub(),c.Vb(6,"div",37),c.Vb(7,"div",38),c.Vb(8,"span"),c.Rc(9,"Th\xf4ng tin chi ti\u1ebft"),c.Ub(),c.Pc(10,ct,2,0,"mat-icon",43),c.Ub(),c.Vb(11,"ul"),c.Pc(12,lt,3,4,"li",44),c.Pc(13,ht,3,3,"li",33),c.Pc(14,dt,4,2,"ng-template",40),c.Ub(),c.Ub(),c.Ub()),2&t){const t=c.gc(6);c.Db(1),c.nc("ngStyle",c.sc(6,at,t.isBackEnd?"15px":"0px")),c.Db(4),c.Sc(t.examResultObj.mark),c.Db(5),c.nc("ngIf",t.isBackEnd),c.Db(2),c.nc("ngIf",t.multipleChoiceList.length>0),c.Db(1),c.nc("ngIf",t.essayQuestionList.length>0),c.Db(1),c.nc("ngIf",t.examTracks&&1==t.examObj.autoMonitor)}}const bt=function(t){return{select:t}};function gt(t,e){if(1&t){const t=c.Wb();c.Vb(0,"li",52),c.cc("click",function(){c.Dc(t);const n=e.$implicit;return c.gc(7).getAndProcessAnswers(n.id)}),c.Rc(1),c.Qb(2,"br"),c.Rc(3),c.hc(4,"date"),c.hc(5,"date"),c.Qb(6,"br"),c.Rc(7),c.Ub()}if(2&t){const t=e.$implicit,n=e.index,i=c.gc(7);c.nc("ngClass",c.sc(11,bt,t.id==i.cur_result)),c.Db(1),c.Tc("L\u1ea7n ",i.examResultObjs.length-n,": "),c.Db(2),c.Uc(" ",c.jc(4,5,t.startedTest,"dd/MM/yyyy, HH:mm")," - ",c.jc(5,8,t.createdAt,"HH:mm")," "),c.Db(4),c.Tc(" Th\u1eddi gian l\xe0m b\xe0i: ",i.calculateTime(t.startedTest,t.createdAt)," ")}}function pt(t,e){if(1&t&&(c.Vb(0,"div",50),c.Vb(1,"div",38),c.Vb(2,"span"),c.Rc(3,"C\xe1c l\u1ea7n thi"),c.Ub(),c.Ub(),c.Vb(4,"ul"),c.Pc(5,gt,8,13,"ng-template",51),c.Ub(),c.Ub()),2&t){const t=c.gc(6);c.Db(5),c.nc("ngForOf",t.examResultObjs)}}function ft(t,e){if(1&t&&(c.Pc(0,ot,17,11,"div",33),c.Pc(1,mt,15,8,"div",33),c.Pc(2,pt,6,1,"div",34)),2&t){const t=c.gc(5);c.nc("ngIf",!t.isBackEnd),c.Db(1),c.nc("ngIf",t.isBackEnd),c.Db(1),c.nc("ngIf",t.isBackEnd)}}function xt(t,e){if(1&t){const t=c.Wb();c.Vb(0,"mat-icon",53),c.cc("click",function(){return c.Dc(t),c.gc(5).toggleNavInfo()}),c.Rc(1,"cancel"),c.Ub()}}function vt(t,e){if(1&t&&(c.Vb(0,"div",54),c.Vb(1,"span"),c.Rc(2),c.Ub(),c.Vb(3,"span"),c.Rc(4),c.Ub(),c.Ub()),2&t){const t=c.gc(5);c.Db(2),c.Sc(t.studentObj.fullName),c.Db(2),c.Tc("\u0110i\u1ec3m cu\u1ed1i: ",t.examResultObj.mark,"")}}function wt(t,e){1&t&&(c.Vb(0,"div",55),c.Rc(1,"Th\xed sinh ch\u01b0a l\xe0m b\xe0i thi!"),c.Ub())}function _t(t,e){if(1&t){const t=c.Wb();c.Vb(0,"mat-icon",56),c.cc("click",function(){return c.Dc(t),c.gc(5).handleNavigate("next")}),c.Rc(1,"navigate_next"),c.Ub()}}function yt(t,e){if(1&t){const t=c.Wb();c.Vb(0,"mat-icon",57),c.cc("click",function(){return c.Dc(t),c.gc(5).handleNavigate("prev")}),c.Rc(1,"navigate_before"),c.Ub()}}function Ot(t,e){if(1&t){const t=c.Wb();c.Vb(0,"div",58),c.Vb(1,"mat-form-field",59),c.Vb(2,"mat-label"),c.Rc(3,"Ch\u1ebf \u0111\u1ed9 xem"),c.Ub(),c.Vb(4,"mat-select",60),c.cc("ngModelChange",function(e){return c.Dc(t),c.gc(5).viewOption=e})("ngModelChange",function(){return c.Dc(t),c.gc(5).onChangeViewOption()}),c.Vb(5,"mat-option",61),c.Rc(6," T\u1ea5t c\u1ea3 "),c.Ub(),c.Vb(7,"mat-option",62),c.Rc(8," C\xe2u sai "),c.Ub(),c.Vb(9,"mat-option",63),c.Rc(10," C\xe2u \u0111\xfang "),c.Ub(),c.Ub(),c.Ub(),c.Ub()}if(2&t){const t=c.gc(5);c.Db(4),c.nc("ngModel",t.viewOption)}}function Pt(t,e){1&t&&(c.Vb(0,"div",68),c.Rc(1,"Vui l\xf2ng ch\u1edd m\u1ed9t ch\xfat, h\u1ec7 th\u1ed1ng \u0111ang x\u1eed l\xfd d\u1eef li\u1ec7u...!"),c.Ub())}function kt(t,e){if(1&t&&c.Qb(0,"azt-loaded-img",69),2&t){const t=c.gc(6);c.nc("imgSrc",t.examObj.examHeader)}}const Dt=function(t,e){return{correct:t,incorrect:e}},Ct=function(){return{}};function It(t,e){if(1&t){const t=c.Wb();c.Vb(0,"azt-question-item",70),c.cc("statusResult",function(n){c.Dc(t);const i=e.$implicit;return c.gc(6).setClassStatusResult(n,i)}),c.Ub()}if(2&t){const t=e.$implicit,n=e.index,i=c.gc(6);c.nc("ngClass",c.tc(9,Dt,t.isStatusResult,!t.isStatusResult))("userAnswersObj",0!=i.examResultObjs.length?i.userAnswersObj:c.rc(12,Ct))("question",t)("configExam",i.examConfig)("isRoleTeacher",i.isRoleTeacher)("index",n)("examObj",i.examObj)("isBackEnd",i.isBackEnd)("cur_result",i.cur_result)}}function Mt(t,e){if(1&t&&(c.Vb(0,"mat-tab",64),c.Pc(1,Pt,2,0,"div",65),c.Vb(2,"div",66),c.Pc(3,kt,1,1,"azt-loaded-img",67),c.Pc(4,It,1,13,"ng-template",51),c.Ub(),c.Ub()),2&t){const t=c.gc(5);c.Db(1),c.nc("ngIf",t.isProcessingPdf),c.Db(1),c.Fb(t.viewOption),c.Db(1),c.nc("ngIf",t.examObj.examHeader),c.Db(1),c.nc("ngForOf",t.questionList)}}function qt(t,e){if(1&t){const t=c.Wb();c.Vb(0,"div",75),c.Vb(1,"azt-mark-essay",76),c.cc("saveResultEvent",function(e){return c.Dc(t),c.gc(6).saveResultEvent(e)}),c.Ub(),c.Ub()}if(2&t){const t=c.gc(6);c.Db(1),c.nc("resultID",t.cur_result)("files",t.files)("questions",t.essayQuestionList)("userAnswersObj",t.userAnswersObj)("iframeSrc",t.iframeSrc)("examQuestionObjs",t.examQuestionObjs)("examResultObj",t.examResultObj)("configExam",t.examConfig)("isBackEnd",t.isBackEnd)("examObj",t.examObj)("isBackEnd",t.isBackEnd)}}function St(t,e){1&t&&(c.Vb(0,"p",77),c.Rc(1," Kh\xf4ng c\xf3 c\xe2u t\u1ef1 lu\u1eadn "),c.Ub())}function jt(t,e){if(1&t&&(c.Vb(0,"mat-tab",71),c.Pc(1,qt,2,11,"div",72),c.Pc(2,St,2,0,"ng-template",73,74,c.Qc),c.Ub()),2&t){const t=c.zc(3),e=c.gc(5);c.Db(1),c.nc("ngIf",e.essayQuestionList.length>0)("ngIfElse",t)}}function Rt(t,e){if(1&t){const t=c.Wb();c.Vb(0,"div",13),c.Vb(1,"div",14),c.Vb(2,"div",15),c.Pc(3,G,1,5,"azt-basic-info-box",16),c.Pc(4,K,3,0,"div",0),c.Pc(5,ft,3,3,"ng-template",null,17,c.Qc),c.Pc(7,xt,2,0,"mat-icon",18),c.Ub(),c.Ub(),c.Pc(8,vt,5,2,"div",19),c.Vb(9,"div",20),c.Vb(10,"div",21),c.Pc(11,wt,2,0,"div",22),c.Pc(12,_t,2,0,"mat-icon",23),c.Pc(13,yt,2,0,"mat-icon",24),c.Vb(14,"div",25),c.Pc(15,Ot,11,1,"div",26),c.Vb(16,"mat-icon",27),c.cc("click",function(){return c.Dc(t),c.gc(4).toggleNavInfo()}),c.Rc(17,"menu_open"),c.Ub(),c.Vb(18,"mat-tab-group",28),c.Pc(19,Mt,5,6,"mat-tab",29),c.Pc(20,jt,4,2,"mat-tab",30),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Ub()}if(2&t){const t=c.zc(6),e=c.gc(4);c.Db(3),c.nc("ngIf",e.isBackEnd),c.Db(1),c.nc("ngIf",0==e.examResultObjs.length)("ngIfElse",t),c.Db(3),c.nc("ngIf",e.isToggleNavInfo),c.Db(1),c.nc("ngIf",e.isBackEnd),c.Db(3),c.nc("ngIf",e.examResultObjs.length<=0),c.Db(1),c.nc("ngIf",e.hasNext()),c.Db(1),c.nc("ngIf",e.hasPrev()),c.Db(2),c.nc("ngIf",0!=e.examResultObjs.length),c.Db(4),c.nc("ngIf",e.multipleChoiceList.length>0),c.Db(1),c.nc("ngIf",e.essayQuestionList.length>0)}}function Tt(t,e){1&t&&(c.Vb(0,"div",78),c.Vb(1,"mat-icon",79),c.Rc(2,"error"),c.Ub(),c.Rc(3," B\u1ea1n ch\u01b0a \u0111\u01b0\u1ee3c xem k\u1ebft qu\u1ea3 thi ! "),c.Ub())}const Ut=function(t){return{toggleNavInfo:t}};function Lt(t,e){if(1&t&&(c.Vb(0,"div",10),c.Pc(1,Rt,21,11,"div",11),c.Pc(2,Tt,4,0,"ng-template",null,12,c.Qc),c.Ub()),2&t){const t=c.zc(3),e=c.gc(3);c.nc("ngClass",c.sc(3,Ut,e.isToggleNavInfo)),c.Db(1),c.nc("ngIf","lang_core_cant_show_answer_when_end_time_not_end"!=e.errorMessage)("ngIfElse",t)}}function Et(t,e){if(1&t&&c.Pc(0,Lt,4,5,"div",9),2&t){const t=c.gc(2);c.nc("ngIf",!t.errorLoadMixedAssets)}}function At(t,e){if(1&t&&c.Qb(0,"azt-loading-effect",80),2&t){const t=c.gc(2);c.nc("customText","\u0110ang t\u1ea3i d\u1eef li\u1ec7u \u0111\u1ec1 thi: "+t.loadMixedExamProgress+"%")}}function Vt(t,e){1&t&&(c.Vb(0,"div",81),c.Vb(1,"mat-icon",79),c.Rc(2,"error"),c.Ub(),c.Rc(3," C\xf3 l\u1ed7i khi t\u1ea3i d\u1eef li\u1ec7u \u0111\u1ec1 thi, h\xe3y th\u1eed l\u1ea1i b\u1eb1ng c\xe1ch t\u1ea3i l\u1ea1i trang web! "),c.Ub())}function Bt(t,e){if(1&t&&(c.Pc(0,H,1,2,"header-backend",2),c.Pc(1,$,1,2,"header-frontend",3),c.Pc(2,Et,1,1,"ng-template",null,4,c.Qc),c.Pc(4,At,1,1,"azt-loading-effect",5),c.Pc(5,Vt,4,0,"div",6)),2&t){const t=c.zc(3),e=c.gc();c.nc("ngIf",e.isBackEnd),c.Db(1),c.nc("ngIf",!e.isBackEnd),c.Db(3),c.nc("ngIf",e.isMixedService_2&&!e.doneLoadMixedExamAssets&&!e.errorLoadMixedAssets)("ngIfElse",t),c.Db(1),c.nc("ngIf",e.errorLoadMixedAssets)}}let Qt=(()=>{class t{constructor(t,e,n,s,a,o,c,r,l,u){this.apiService=t,this.dialog=e,this.commonService=n,this.translate=s,this.localize=a,this.activeRoute=o,this.router=c,this.store=r,this.mixService=l,this.mixService2=u,this.isBackEnd=!0,this.subscription=new i.a,this.isRoleTeacher=!0,this.headerTitle="T\xean \u0111\u1ec1 thi",this.back_link="",this.viewOption="viewAll",this.cur_result=0,this.cur_exam=0,this.cur_user=0,this.cur_student=0,this.hash_id=0,this.tenant_id=0,this.cate_id=0,this.tested_user_objs=[],this.studentObj={},this.examResultObjs=[],this.examResultObj={},this.examConfig={},this.questionList=[],this.essayQuestionList=[],this.multipleChoiceList=[],this.userAnswersObj={},this.files=[],this.countEssayQuestion=0,this.iframeSrc="",this.isLoading=!1,this.isProcessingPdf=!1,this.isToggleNavInfo=!1,this.isShowFadingLayer=!1,this.examQuestionObjs=[],this.backtoLink="",this.isMixedService_2=!1,this.doneLoadMixedExamAssets=!1,this.errorLoadMixedAssets=!1,this.countLoadedMixedAssets=0,this.totalMixedExamAssets=0,this.errorMessage="",this.markedByObj=null}get loadMixedExamProgress(){return Math.round(this.countLoadedMixedAssets/this.totalMixedExamAssets*100)}setClassStatusResult(t,e){Object(s.a)(100).subscribe(()=>e.isStatusResult=t)}calculateTime(t,e){return this.commonService.calculationTestedTime(t,e)}onChangeViewOption(){}saveResultEvent(t){t&&this.apiService.GetExamWithExamAnswer(this.cur_result,1).subscribe(t=>{1==t.success?this.examResultObj=t.data.examResultObj:this.handleError(t)})}convertAnswersArr(t){0!=t.length&&t.forEach(t=>{this.userAnswersObj["id_"+t.QuestionId]=t.AnswerContent[0].Content})}getAndProcessAnswers(t){var e=this.commonService.getLocalRouter("/admin/testbank/test-review/"+this.cur_exam+"/"+this.cur_user+"/"+this.cur_student+"/"+t)+"?backto="+encodeURIComponent(this.backtoLink);window.location.href=e.toString()}checkEssay(){for(let t=0;t<this.questionList.length;t++)3==this.questionList[t].answerType&&(this.questionList[t].indexLabel=t,this.essayQuestionList.push(this.questionList[t]))}checkMultipleChoice(){for(let t=0;t<this.questionList.length;t++)1!=this.questionList[t].answerType&&4!=this.questionList[t].answerType||(this.questionList[t].indexLabel=t,this.multipleChoiceList.push(this.questionList[t]))}get checkHasType1Question(){let t=!1;for(let e=0;e<this.questionList.length;e++)if(1==this.questionList[e].answerType){t=!0;break}return t}processConvertData(t){this.examQuestionObjs=t.data.examQuestionObjs,this.examResultObj=t.data.examResultObj,this.examResultTrack=t.data.resultTracks,this.examConfig=t.data.examObj,this.questionList=t.data.questionObjs,this.questionList.forEach(t=>{t.answerConfig=JSON.parse(t.answerConfig),t.answerResult=JSON.parse(t.answerResult),t.coordinates=JSON.parse(t.coordinates),t.questionContent=JSON.parse(t.questionContent),t.isRoleTeacher=this.isBackEnd}),this.countEssayQuestion=this.essayQuestionCounter(this.questionList),this.commonService.replaceCanvasBackground(this.questionList),this.checkEssay(),this.checkMultipleChoice(),this.convertAnswersArr(JSON.parse(t.data.examResultObj.answers)),this.processUserFiles(t.data.examResultObj.files)}essayQuestionCounter(t){var e=0;return t.forEach(t=>{2!=t.answerType&&3!=t.answerType||e++}),e}getAndProcessData(){this.isLoading=!0,this.cur_user=this.activeRoute.snapshot.paramMap.get("user_id"),this.cur_student=this.activeRoute.snapshot.paramMap.get("student_id"),this.cur_result=this.activeRoute.snapshot.paramMap.get("result_id"),this.getTestedUsers(()=>{this.apiService.GetLastExamResultOfStudentId(this.cur_exam,this.cur_user,this.cur_student,1).subscribe(t=>{1==t.success?t.data.examResultObjs&&t.data.examResultObjs.length>0?(this.studentObj=t.data.studentObj,this.examResultObjs=t.data.examResultObjs,this.headerTitle=t.data.lastExamResultObj.examObj.name,this.cur_result="0"==this.cur_result?t.data.examResultObjs[0].id:this.cur_result,this.apiService.GetExamWithExamAnswer(this.cur_result,1).subscribe(t=>{1==t.success?(this.examTracks=t.data.examTracks,this.examObj=t.data.examObj,this.markedByObj=t.data.markedByObj,this.processConvertData(t),this.translateMetaTitle(t),this.processMixQuestion(t.data.questionObjs[0].name.startsWith("[PDFv2]")),this.isLoading=!1):(this.isLoading=!1,this.handleError(t))})):(this.isLoading=!1,this.studentObj=t.data.studentObj):(this.isLoading=!1,this.handleError(t))})})}getAndProcessDataForStudent(){this.isLoading=!0,Object(a.b)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{var t,e=null===(t=this.commonService.getMyParam(this.activeRoute,"hash_id"))||void 0===t?void 0:t.toString();this.tenant_id=Number(this.commonService.getMyParam(this.activeRoute,"tenant_id")),this.cate_id=Number(this.commonService.getMyParam(this.activeRoute,"cate_id")),this.cur_result=Number(this.commonService.getMyParam(this.activeRoute,"result_id")),this.hash_id=e||"";var n=this.commonService.getSimpleSessionStorageWithExpired("result_result_"+this.cur_result);if(n){if(this.examObj=n.examObj,this.headerTitle="K\u1ebft qu\u1ea3: "+n.examObj.name,this.translateMetaTitle({data:n}),this.examResultObjs=[1],this.processConvertData({data:n}),null!=n.questionObjs&&n.questionObjs.length>0&&n.questionObjs[0].name.startsWith("[PDFv2]"))if(this.examObj.labelsUrl.startsWith("[")){this.isMixedService_2=!0;let t=this.commonService.parseJson(this.examObj.labelsUrl);this.totalMixedExamAssets=t.length;let e=t.map(t=>!0),n={},i=[],s=0;for(let a=0;a<t.length;a++)n["index_"+a]=this.commonService.getMyCdn(t[a]);for(const a in n){let o=new Image;o.crossOrigin="anonymous";let c=n[a],r=0;o.onload=()=>{this.countLoadedMixedAssets++,s++,i[parseInt(a.split("_")[1])]=o,s==t.length&&(this.mixService2.drawMixQuestion(i,this.questionList,this.examObj),setTimeout(()=>{this.doneLoadMixedExamAssets=!0},1e3))},o.onerror=()=>{r<2?setTimeout(()=>{let t="";switch(r){case 0:t=this.commonService.isViettelCDN(t)?this.commonService.getRawCdnLink(c)+"?t="+Date.now():this.commonService.getRawCdnLink(c);break;default:t=this.commonService.getRawCdnLink(c)+"?t="+Date.now()}o.src=t,r++},3e3):(e[parseInt(a.split("_")[1])]=!1,this.errorLoadMixedAssets=!0,this.mixService2.trackPdfV2Error(c))},o.src=c}}else this.mixService.drawMixQuestion(this.examObj.labelsUrl,this.questionList,this.examObj);this.back_link="/de-thi/"+this.hash_id,this.isLoading=!1}else this.apiService.GetFrontExamWithExamAnswer(this.hash_id,this.cur_result).subscribe(t=>{if(1==t.success){if(this.examObj=t.data.examObj,this.headerTitle="K\u1ebft qu\u1ea3: "+t.data.examObj.name,this.errorMessage=t.data.errorMessage,this.translateMetaTitle(t),this.examResultObjs=[1],this.processConvertData(t),null!=t.data.questionObjs&&t.data.questionObjs.length>0&&t.data.questionObjs[0].name.startsWith("[PDFv2]"))if(this.examObj.labelsUrl.startsWith("[")){this.isMixedService_2=!0;let t=this.commonService.parseJson(this.examObj.labelsUrl);this.totalMixedExamAssets=t.length;let e=t.map(t=>!0),n={},i=[],s=0;for(let a=0;a<t.length;a++)n["index_"+a]=this.commonService.getMyCdn(t[a]);for(const a in n){let o=new Image;o.crossOrigin="anonymous";let c=n[a],r=0;o.onload=()=>{this.countLoadedMixedAssets++,s++,i[parseInt(a.split("_")[1])]=o,s==t.length&&(this.mixService2.drawMixQuestion(i,this.questionList,this.examObj),setTimeout(()=>{this.doneLoadMixedExamAssets=!0},1e3))},o.onerror=()=>{r<=3?setTimeout(()=>{o.src=this.commonService.getRawCdnLink(c),r++},3e3):(e[parseInt(a.split("_")[1])]=!1,this.errorLoadMixedAssets=!0,this.mixService2.trackPdfV2Error(c))},o.src=c}}else this.mixService.drawMixQuestion(this.examObj.labelsUrl,this.questionList,this.examObj);this.back_link="/de-thi/"+this.hash_id,this.isLoading=!1}else this.isLoading=!1,this.handleError(t)})})}processMixQuestion(t){if(t)if(this.examObj.labelsUrl.startsWith("[")){this.isMixedService_2=!0;let t=this.commonService.parseJson(this.examObj.labelsUrl);this.totalMixedExamAssets=t.length;let e=t.map(t=>!0),n={},i=[],s=0;for(let a=0;a<t.length;a++)n["index_"+a]=this.commonService.getMyCdn(t[a]);for(const a in n){let o=new Image;o.crossOrigin="anonymous";let c=n[a],r=0;o.onload=()=>{this.countLoadedMixedAssets++,s++,i[parseInt(a.split("_")[1])]=o,s==t.length&&(this.mixService2.drawMixQuestion(i,this.questionList,this.examObj),setTimeout(()=>{this.doneLoadMixedExamAssets=!0},1e3))},o.onerror=()=>{r<3?setTimeout(()=>{let t="";switch(r){case 0:t=this.commonService.isViettelCDN(t)?this.commonService.getRawCdnLink(c)+"?t="+Date.now():this.commonService.getRawCdnLink(c);break;default:t=this.commonService.getRawCdnLink(c)+"?t="+Date.now()}o.src=t,r++},3e3):(e[parseInt(a.split("_")[1])]=!1,this.errorLoadMixedAssets=!0,this.mixService2.trackPdfV2Error(c))},o.src=c}}else this.mixService.drawMixQuestion(this.examObj.labelsUrl,this.questionList,this.examObj)}translateMetaTitle(t){let e=this.isBackEnd?"Ch\u1ea5m \u0111\u1ec1 thi: ":"K\u1ebft qu\u1ea3: ";this.commonService.translateMetaData({title:e+t.data.examObj.name,description:e+t.data.examObj.name,image:"lang_cms_test_image"})}processUserFiles(t){this.files=""!=t?JSON.parse(t):[]}progressUserObjsList(t,e){var n=[];return t.length>0&&(n=t),e.forEach(t=>{t.results.forEach(t=>{n.push(t)})}),n}getTestedUsers(t){var e=this.commonService.getSimpleSessionStorageWithExpired("tested_exam_result");e?(this.tested_user_objs=e,t()):this.apiService.getTestedUserObjs("test_review",this.cur_exam).subscribe(e=>{1==e.success&&(this.tested_user_objs=this.progressUserObjsList(e.data.studentsNotInClassResults,e.data.studentsInClassResults),this.commonService.saveSimpleSessionStorageWithExpired("tested_exam_result",this.tested_user_objs)),t()})}handleError(t){this.commonService.myTranslate([t.message,"lang_cms_common_ok"]).subscribe(e=>{this.commonService.snackError(e[t.message],e.lang_cms_common_ok)})}hasNext(){for(var t=-1,e=0;e<this.tested_user_objs.length;e++)if(this.tested_user_objs[e].userId==this.cur_user&&this.tested_user_objs[e].studentId==this.cur_student){t=e;break}return t<this.tested_user_objs.length-1}hasPrev(){for(var t=-1,e=0;e<this.tested_user_objs.length;e++)if(this.tested_user_objs[e].userId==this.cur_user&&this.tested_user_objs[e].studentId==this.cur_student){t=e;break}return t>0}handleNavigate(t){for(var e=-1,n=0;n<this.tested_user_objs.length;n++)if(this.tested_user_objs[n].userId==this.cur_user&&this.tested_user_objs[n].studentId==this.cur_student){e=n;break}if("next"==t){if(e>=0&&e<=this.tested_user_objs.length-2){var i=this.tested_user_objs[e+1].userId.toString(),s=this.tested_user_objs[e+1].studentId.toString(),a=this.commonService.getLocalRouter("/admin/testbank/test-review/"+this.cur_exam+"/"+i+"/"+s+"/0")+"?backto="+encodeURIComponent(this.backtoLink);window.location.href=a.toString()}}else e>0&&e<=this.tested_user_objs.length-1&&(i=this.tested_user_objs[e-1].userId.toString(),s=this.tested_user_objs[e-1].studentId.toString(),a=this.commonService.getLocalRouter("/admin/testbank/test-review/"+this.cur_exam+"/"+i+"/"+s+"/0")+"?backto="+encodeURIComponent(this.backtoLink),window.location.href=a.toString())}toggleNavInfo(){this.isToggleNavInfo=!this.isToggleNavInfo}clickExportPdf(){this.commonService.gaEvent("click_exp_pdf_in_test_review");const t=this.localize.translateRoute("/admin/testbank/export-tool")+"/"+this.cur_exam+"/"+this.cur_user+"/"+this.cur_student+"/"+this.cur_result+"?ref=test-review";window.open(t,"_blank")}clickResultTrack(){this.commonService.gaEvent("click_exp_pdf_in_test_review");const t=this.localize.translateRoute("/admin/testbank/test-result-tracking")+"/"+this.cur_exam+"/"+this.cur_user+"/"+this.cur_student+"/"+this.cur_result;window.open(t,"_blank")}redirectToBackLink(){if(!this.backtoLink.includes("enter-question"))return this.commonService.myNavigationWithQueryString("/de-thi/"+this.hash_id,"?backto="+encodeURIComponent(this.backtoLink));this.commonService.myNavigation(this.backtoLink)}toggleQA(){this.store.dispatch(o.c())}continueQA(){this.store.dispatch(o.a({selectTest:{id:this.examObj.id,name:this.examObj.name},resultId:this.cur_result})),this.commonService.myNavigation("/student-qa")}ngOnInit(){this.subscription.add(this.store.subscribe(t=>{this.state=t})),this.iframeSrc=this.commonService.getEnvValue("classliveUrl"),Object(a.b)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{this.isRoleTeacher=this.isBackEnd,this.backtoLink=this.commonService.getMyQueryParam("backto"),this.isBackEnd?(this.cur_exam=this.activeRoute.snapshot.paramMap.get("exam_id"),this.back_link=this.backtoLink?this.backtoLink:"/admin/testbank/tested-list/0/"+this.cur_exam+"/0",this.getAndProcessData()):this.getAndProcessDataForStudent()})}ngAfterContentInit(){}ngOnDestroy(){this.subscription.unsubscribe(),this.commonService.stopIntervalFunc("test_review")}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(r.a),c.Pb(l.b),c.Pb(u.a),c.Pb(h.c),c.Pb(d.e),c.Pb(m.a),c.Pb(m.i),c.Pb(b.h),c.Pb(g.a),c.Pb(p.a))},t.\u0275cmp=c.Jb({type:t,selectors:[["azt-test-review"]],inputs:{isBackEnd:"isBackEnd"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["doneLoading",""],[3,"headerTitle","back_link",4,"ngIf"],[3,"headerTitle","checkUrlFunction","RedirectToLink",4,"ngIf"],["myContent",""],[3,"customText",4,"ngIf","ngIfElse"],["class","p-5 m-5 text-center alert alert-danger",4,"ngIf"],[3,"headerTitle","back_link"],[3,"headerTitle","checkUrlFunction","RedirectToLink"],["id","test_review_container","class","container-fluid mt-2",3,"ngClass",4,"ngIf"],["id","test_review_container",1,"container-fluid","mt-2",3,"ngClass"],["id","tabRowExam","class","row","style","margin-bottom: 10px;",4,"ngIf","ngIfElse"],["NotTimeYet",""],["id","tabRowExam",1,"row",2,"margin-bottom","10px"],["id","col_std_info",1,"col-md-4","col-lg-3"],["id","tester-info"],[3,"name","avatarUrl","birthDay","phone","studentObj",4,"ngIf"],["allReadyTested",""],["id","close_button",3,"click",4,"ngIf"],["id","short_cut_mobile","class","col-md-4 col-lg-3 mb-3",4,"ngIf"],["id","test_review_area",1,"col-md-8","col-lg-9"],["id","col_examContent_wrap"],["class","text-center",4,"ngIf"],["class","clickable next_icon",3,"click",4,"ngIf"],["class","clickable prev_icon",3,"click",4,"ngIf"],["id","mbTestContent"],["id","filterWrap",4,"ngIf"],[1,"clickable",3,"click"],[1,"test-review-tab"],["label","Tr\u1eafc nghi\u1ec7m",4,"ngIf"],["id","tabEssay","label","T\u1ef1 lu\u1eadn","aria-labelledby","tabEssay",4,"ngIf"],[3,"name","avatarUrl","birthDay","phone","studentObj"],[1,"d-flex","justify-content-center","py-2"],[4,"ngIf"],["class","tested-times","style","overflow: auto;",4,"ngIf"],["id","fullPoint",3,"ngStyle"],["class","point",4,"ngIf"],[1,"tested-times"],[1,"label","d-flex","justify-content-between","align-items-center"],["matTooltip","T\u1ea3i b\xe0i l\xe0m n\xe0y d\u01b0\u1edbi d\u1ea1ng PDF","class","clickable","style","color: darkgrey;",3,"click",4,"ngIf"],[3,"ngIf"],[1,"point"],["matTooltip","T\u1ea3i b\xe0i l\xe0m n\xe0y d\u01b0\u1edbi d\u1ea1ng PDF",1,"clickable",2,"color","darkgrey",3,"click"],["matTooltip","T\u1ea3i b\xe0i l\xe0m d\u01b0\u1edbi d\u1ea1ng pdf","class","clickable","style","color: darkgrey;",3,"click",4,"ngIf"],["class","d-flex justify-content-between align-items-center",4,"ngIf"],["matTooltip","T\u1ea3i b\xe0i l\xe0m d\u01b0\u1edbi d\u1ea1ng pdf",1,"clickable",2,"color","darkgrey",3,"click"],[1,"d-flex","justify-content-between","align-items-center"],["matTooltip","Xem chi ti\u1ebft qu\xe1 tr\xecnh l\xe0m b\xe0i tr\u1eafc nghi\u1ec7m","class","ml-1 clickable","style","color: darkgrey;",3,"click",4,"ngIf"],["matTooltip","Xem chi ti\u1ebft qu\xe1 tr\xecnh l\xe0m b\xe0i tr\u1eafc nghi\u1ec7m",1,"ml-1","clickable",2,"color","darkgrey",3,"click"],[2,"cursor","pointer",3,"matTooltip","nameCreateAvatar","size","linkAvatar"],[1,"tested-times",2,"overflow","auto"],["ngFor","",3,"ngForOf"],[1,"clickable",3,"ngClass","click"],["id","close_button",3,"click"],["id","short_cut_mobile",1,"col-md-4","col-lg-3","mb-3"],[1,"text-center"],[1,"clickable","next_icon",3,"click"],[1,"clickable","prev_icon",3,"click"],["id","filterWrap"],["appearance","fill"],[3,"ngModel","ngModelChange"],["value","viewAll"],["value","viewWrong"],["value","viewRight"],["label","Tr\u1eafc nghi\u1ec7m"],["class","fading_layer",4,"ngIf"],["id","multipleChoiceWrap"],["style","display: block","class","mb-1",3,"imgSrc",4,"ngIf"],[1,"fading_layer"],[1,"mb-1",2,"display","block",3,"imgSrc"],[3,"ngClass","userAnswersObj","question","configExam","isRoleTeacher","index","examObj","isBackEnd","cur_result","statusResult"],["id","tabEssay","label","T\u1ef1 lu\u1eadn","aria-labelledby","tabEssay"],["id","markEssay",4,"ngIf","ngIfElse"],["class","pt-2"],["notHaveEssay",""],["id","markEssay"],[3,"resultID","files","questions","userAnswersObj","iframeSrc","examQuestionObjs","examResultObj","configExam","isBackEnd","examObj","saveResultEvent"],[1,"p-3"],[1,"m-5","text-center","alert","alert-danger"],[2,"vertical-align","bottom"],[3,"customText"],[1,"p-5","m-5","text-center","alert","alert-danger"]],template:function(t,e){if(1&t&&(c.Pc(0,J,1,0,"azt-loading-effect",0),c.Pc(1,Bt,6,5,"ng-template",null,1,c.Qc)),2&t){const t=c.zc(2);c.nc("ngIf",e.isLoading)("ngIfElse",t)}},directives:[f.m,x.a,v.a,w.a,f.k,_.a,y.b,q,f.n,P.a,O.a,f.l,S.d,S.g,j.a,R.r,R.u,T.n,y.a,U.a,L.a,W],pipes:[f.e],styles:["#test_review_container[_ngcontent-%COMP%]{background:#ecf0f5;flex:auto;padding-top:15px}#tester-info[_ngcontent-%COMP%]{width:300px;padding:15px;background-color:#fff;margin:0 auto;position:sticky;top:10px;max-height:calc(100vh - 10px);display:flex;flex-direction:column;max-width:100%;border-radius:3px;border:1px solid #f1f1f1}#short_cut_mobile[_ngcontent-%COMP%]{display:none}#fullPoint[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1px solid #f1f1f1;background-color:#fafafa;padding:10px;margin-top:15px;align-items:center}#fullPoint[_ngcontent-%COMP%]   .point[_ngcontent-%COMP%]{font-weight:500;font-size:130%}.tested-times[_ngcontent-%COMP%]{margin-top:15px}.tested-times[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{border:1px solid #f1f1f1;background-color:#fafafa;padding:10px}.tested-times[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;border:1px solid #f1f1f1;border-top:none;margin-bottom:0;background-color:#fff;padding:10px}.tested-times[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px}.tested-times[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.tested-times[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.select[_ngcontent-%COMP%]{font-weight:500}.tested-times[_ngcontent-%COMP%]:last-child{flex:auto;overflow:auto}#multipleChoiceWrap[_ngcontent-%COMP%]{background-color:#fff;padding:30px;position:relative}.fading_layer[_ngcontent-%COMP%]{position:absolute;z-index:9;background-color:hsla(0,0%,100%,.8901960784313725);width:100%;height:100%;top:0;left:0;padding-top:200px;text-align:center;color:#a9a9a9;font-size:16px}#filterWrap[_ngcontent-%COMP%]{position:absolute;right:0;top:-4px;z-index:2}.viewRight[_ngcontent-%COMP%]   .incorrect[_ngcontent-%COMP%], .viewWrong[_ngcontent-%COMP%]   .correct[_ngcontent-%COMP%]{display:none}#col_examContent_wrap[_ngcontent-%COMP%]{width:1100px}#col_examContent_wrap[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{position:fixed;right:5px;top:50%;z-index:3;font-size:35px;width:40px;height:40px;display:flex;align-items:center;justify-content:center;background-color:hsla(0,0%,78.8%,.7725490196078432);border-radius:50%;color:#fff;margin-top:-20px}#col_examContent_wrap[_ngcontent-%COMP%] > mat-icon.prev_icon[_ngcontent-%COMP%]{left:5px}#mbTestContent[_ngcontent-%COMP%]{position:relative}#mbTestContent[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{display:none;position:absolute;top:12px;color:#646464;z-index:100}#test_review_container.toggleNavInfo[_ngcontent-%COMP%]   #col_std_info[_ngcontent-%COMP%]{left:0}#close_button[_ngcontent-%COMP%]{color:red;position:absolute;right:5px;top:5px}@media screen and (max-width:320px){#tester-info[_ngcontent-%COMP%]{width:100%}}@media screen and (max-width:480px){#mbTestContent[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{display:inline-block}#boxQAButtons[_ngcontent-%COMP%]{position:fixed;right:20px;z-index:99999999999999;bottom:10px;background-color:#fff;border:1px solid #a3a3a3;padding:5px;border-radius:4px}#test_review_container[_ngcontent-%COMP%]{padding-top:0}#col_std_info[_ngcontent-%COMP%]{position:fixed;top:0;left:-100%;z-index:99999;background:rgba(0,0,0,.611764705882353);bottom:0;padding:0;transition:all .5s}#short_cut_mobile[_ngcontent-%COMP%]{display:flex;font-weight:500;font-size:18px;justify-content:space-between;color:#4a4a4a}#header-app-component[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:last-child{padding-left:0!important}#tester-info[_ngcontent-%COMP%]{margin:0;position:relative;height:100%;max-height:unset;top:0}#multipleChoiceWrap[_ngcontent-%COMP%]{padding-right:5px;padding-left:5px;padding-top:5px}}@media screen and (max-width:1600px){#col_examContent_wrap[_ngcontent-%COMP%]{width:100%}}"]}),t})()},RtGS:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("mrSG"),s=n("quSY"),a=n("fXoL"),o=n("gbi4"),c=n("yTNM");let r=(()=>{class t{constructor(t,e){this.commonService=t,this.apiService=e,this.labelsImgs=[],this.questionLabelMap=[],this.abcdLabelPos={},this.subscription=new s.a,this.drawMixQuestion=(t,e,n)=>Object(i.a)(this,void 0,void 0,function*(){this.labelsImgs=t,this.questionLabelMap=e[0].questionContent[0].questionLabelMap?e[0].questionContent[0].questionLabelMap:this.commonService.parseJson(n.questionLabelMap),this.abcdLabelPos=e[0].questionContent[0].abcdLabelPos?e[0].questionContent[0].abcdLabelPos:this.commonService.parseJson(n.abcdLabelPos);const i={width:1,height:1,top:1,left:1};e.forEach(t=>{1==t.isImage&&(t.mixDataImg="https://cdn.jsdelivr.net/gh/azota889/storage_public/azota_assets/svgs/Img2_dat-01.svg",t.answerLabelsMockup={"label-A":i,"label-B":i,"label-C":i,"label-D":i,"label-E":i,"label-F":i})});for(let t=0;t<e.length;t++)1==e[t].answerType?this.drawForType1(e[t].answerConfig,e[t].questionContent[0],t,e):this.prepareImageForOtherTypes(e[t].questionContent[0],t,e)})}drawForType1(t,e,n,i){let s=t.map(t=>this.commonService.parseJson(t.content));const a=()=>this.questionLabelMap[n].width>e.metaData.question.remove.width?this.questionLabelMap[n].width-e.metaData.question.remove.width:0;let o=document.createElement("canvas");o.width=e.metaData.question.width+a(),o.height=e.metaData.question.height;let c=o.getContext("2d");null==c||c.drawImage(this.labelsImgs[e.metaData.question.posit.locate],e.metaData.question.posit.left,e.metaData.question.posit.top,e.metaData.question.width,e.metaData.question.height,a(),0,e.metaData.question.width,e.metaData.question.height),null==c||c.drawImage(this.labelsImgs[0],this.questionLabelMap[n].left,this.questionLabelMap[n].top,this.questionLabelMap[n].width,this.questionLabelMap[n].height,e.metaData.question.remove.x,e.metaData.question.remove.y,this.questionLabelMap[n].width,this.questionLabelMap[n].height);let r=s[0],l=0,u=0,h=0,d=e.metaData.answers[0].x,m=e.metaData.answers[0].y;l=d,u=d+r.width,h=d+r.width;let b=s[0].height-e.metaData.answers[0].height;null==c||c.drawImage(this.labelsImgs[r.posit.locate],r.posit.left,r.posit.top,r.width,r.height,d,m,r.width,r.height);let g=t[0].alpha?t[0].alpha:t[0].key,p=0;if(t[0].alpha){let e=t[0].key;for(let n=0;n<t.length;n++)if(e==t[n].alpha){p=n;break}}let f={left:void 0!==e.metaData.answers[p].remove.xAns?d+e.metaData.answers[p].remove.xAns:e.metaData.answers[0].remove.x,top:void 0!==e.metaData.answers[p].remove.yAns?m+e.metaData.answers[p].remove.yAns:e.metaData.answers[0].remove.y,width:e.metaData.answers[0].remove.width,height:e.metaData.answers[0].remove.height};null==c||c.drawImage(this.labelsImgs[0],this.abcdLabelPos[g].left,this.abcdLabelPos[g].top,e.metaData.answers[0].remove.width,e.metaData.answers[0].remove.height,f.left,f.top,f.width,f.height),i[n].answerLabelsMockup["label-"+(t[0].alpha?t[0].alpha:t[0].key)]=f;for(let x=1;x<t.length;x++){let a=e.metaData.answers[x].x,r=e.metaData.answers[x].y;if(l+30<a){let t=[h,u];a<Math.max(...t)&&(a=Math.max(...t),a+s[x].width>o.width&&(a-=a+s[x].width-o.width),e.metaData.answers[x].remove.x=a),u+=s[x].width}else if(u=l+s[x].width,r+=b,b+=s[x].height-e.metaData.answers[x].height,r+s[x].height>o.height){let t=r+s[x].height-o.height;r-=t,e.metaData.answers[x].remove.y-=t}null==c||c.drawImage(this.labelsImgs[s[x].posit.locate],s[x].posit.left,s[x].posit.top,s[x].width,s[x].height,a,r,s[x].width,s[x].height);let d=x,m=t[x].alpha?t[x].alpha:t[x].key;if(t[x].alpha){let e=t[x].key;for(let n=0;n<t.length;n++)if(e==t[n].alpha){d=n;break}}let g={left:void 0!==e.metaData.answers[d].remove.xAns?a+e.metaData.answers[d].remove.xAns:e.metaData.answers[x].remove.x,top:void 0!==e.metaData.answers[d].remove.yAns?r+e.metaData.answers[d].remove.yAns:e.metaData.answers[x].remove.y,width:e.metaData.answers[x].remove.width,height:e.metaData.answers[x].remove.height};null==c||c.drawImage(this.labelsImgs[0],this.abcdLabelPos[m].left,this.abcdLabelPos[m].top,e.metaData.answers[x].remove.width,e.metaData.answers[x].remove.height,g.left,g.top,g.width,g.height),i[n].answerLabelsMockup["label-"+(t[x].alpha?t[x].alpha:t[x].key)]=g,x==t.length-1&&(i[n].mixDataImg=o.toDataURL("image/png"))}}prepareImageForOtherTypes(t,e,n){const i=()=>this.questionLabelMap[e].width>t.metaData.question.remove.width?this.questionLabelMap[e].width-t.metaData.question.remove.width:0;let s=document.createElement("canvas");s.width=t.metaData.question.width+i(),s.height=t.metaData.question.height;let a=s.getContext("2d"),o=t.metaData.question.urlExcludeLabelOnly;const c=()=>{null==a||a.drawImage(this.labelsImgs[0],this.questionLabelMap[e].left,this.questionLabelMap[e].top,this.questionLabelMap[e].width,this.questionLabelMap[e].height,t.metaData.question.remove.x,t.metaData.question.remove.y,this.questionLabelMap[e].width,this.questionLabelMap[e].height),n[e].mixDataImg=s.toDataURL("image/png")};if(o){let t=new Image;t.onload=()=>{null==a||a.drawImage(t,i(),0),c()},t.src=o}else null==a||a.drawImage(this.labelsImgs[t.metaData.question.posit.locate],t.metaData.question.posit.left,t.metaData.question.posit.top,t.metaData.question.width,t.metaData.question.height,i(),0,t.metaData.question.width,t.metaData.question.height),c()}trackPdfV2Error(t){let e,n;try{n=localStorage.getItem("user_obj"),e=n?JSON.parse(n).id:"unknown"}catch(a){e="browser_not_local_storage"}let i=document.URL.split("?")[0].split("/"),s={userId:e,trackKey:"V2_ERR_DISPLAY",name:"Track l\u1ed7i kh\xf4ng hi\u1ec3n th\u1ecb c\xe2u h\u1ecfi v2",userAgent:navigator.userAgent,content:t,url:document.URL,error:i[i.length-1]};this.subscription.add(this.apiService.saveTrackLog(s).subscribe(t=>{console.log("Track l\u1ed7i th\xe0nh c\xf4ng!")}))}}return t.\u0275fac=function(e){return new(e||t)(a.Zb(o.a),a.Zb(c.a))},t.\u0275prov=a.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},SPOn:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("fXoL"),s=n("gbi4");let a=(()=>{class t{constructor(t){this.commonService=t}convertUrl(){this.src=this.commonService.getRawCdnLink(this.src)}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(s.a))},t.\u0275dir=i.Kb({type:t,selectors:[["","appImageFallback",""]],hostVars:1,hostBindings:function(t,e){1&t&&i.cc("error",function(){return e.convertUrl()}),2&t&&i.Yb("src",e.src,i.Ic)},inputs:{src:"src"}}),t})()},Vwpm:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("fXoL"),s=n("ofXK"),a=n("SPOn"),o=n("gaSO");function c(t,e){1&t&&(i.Vb(0,"div",2),i.Qb(1,"img",3),i.Ub())}let r=(()=>{class t{constructor(){this.loading=!0}onLoad(){this.loading=!1}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Jb({type:t,selectors:[["azt-loaded-img"]],inputs:{imgSrc:"imgSrc",id:"id"},decls:4,vars:8,consts:[["class","px-4 py-3 text-center",4,"ngIf"],["appImageFallback","",2,"width","100%",3,"hidden","src","alt","load"],[1,"px-4","py-3","text-center"],["src","https://cdn.jsdelivr.net/gh/azota889/storage_public/azota_assets/svgs/Img2_dat-01.svg","alt","image_loading_placeholer"]],template:function(t,e){1&t&&(i.Vb(0,"div"),i.Pc(1,c,2,0,"div",0),i.Vb(2,"img",1),i.cc("load",function(){return e.onLoad()}),i.hc(3,"mycdn"),i.Ub(),i.Ub()),2&t&&(i.Db(1),i.nc("ngIf",e.loading),i.Db(1),i.Fb(e.id?"img-fluid questionId_"+e.id:"img-fluid"),i.oc("src",i.ic(3,6,e.imgSrc),i.Hc),i.oc("alt",e.imgSrc),i.nc("hidden",e.loading))},directives:[s.m,a.a],pipes:[o.n],styles:[""]}),t})()},gJ4n:function(t,e,n){"use strict";n.d(e,"a",function(){return _t});var i=n("fXoL"),s=n("quSY"),a=n("UETp"),o=n("tyNb"),c=n("gbi4"),r=n("Avyq"),l=n("yTNM"),u=n("l7P3"),h=n("ofXK"),d=n("Qu3c"),m=n("SPOn"),b=n("Vwpm"),g=n("gaSO");function p(t,e){if(1&t&&(i.Vb(0,"div",10),i.Qb(1,"img",11),i.hc(2,"mycdn"),i.Ub()),2&t){const t=i.gc(2).$implicit,e=i.gc(2);i.nc("hidden",e.checkHiddenGroup(t.firstInGroupIndexes,e.index)),i.Db(1),i.oc("src",i.ic(2,2,t.groupUrl),i.Hc)}}function f(t,e){if(1&t&&(i.Vb(0,"div",12),i.Qb(1,"iframe",13),i.hc(2,"safe"),i.Ub()),2&t){const t=i.gc(2).$implicit;i.Db(1),i.nc("src",i.ic(2,1,t.url),i.Fc)}}function x(t,e){if(1&t&&i.Qb(0,"azt-loaded-img",15),2&t){const t=i.gc(3).$implicit,e=i.gc(2);i.nc("id",e.question.id)("imgSrc",t.url)}}function v(t,e){if(1&t&&i.Pc(0,x,1,2,"azt-loaded-img",14),2&t){const t=i.gc(2).$implicit;i.nc("ngIf","png"==t.extension||"jpg"==t.extension)}}function w(t,e){if(1&t&&(i.Tb(0),i.Qb(1,"img",16),i.hc(2,"mycdn"),i.Sb()),2&t){const t=i.gc(4);i.Db(1),i.Fb("img-fluid img_respon questionId_"+t.question.id),i.pc("id","questionPlaceholder_",t.index,""),i.oc("src",i.ic(2,5,t.question.mixDataImg),i.Hc)}}function _(t,e){if(1&t&&(i.Vb(0,"div"),i.Pc(1,p,3,4,"div",6),i.Pc(2,f,3,3,"div",7),i.Pc(3,v,1,1,"ng-template",null,8,i.Qc),i.Pc(5,w,3,7,"ng-container",9),i.Ub()),2&t){const t=i.zc(4),e=i.gc().$implicit,n=i.gc(2);i.Db(1),i.nc("ngIf",e.groupUrl),i.Db(1),i.nc("ngIf","mp4"==e.extension),i.Db(3),i.nc("ngIf",n.question.name.startsWith("[PDFv2]"))("ngIfElse",t)}}function y(t,e){if(1&t&&(i.Vb(0,"audio",19),i.Qb(1,"source",20),i.hc(2,"safe"),i.hc(3,"mycdn"),i.Ub()),2&t){const t=i.gc(4);i.oc("id","audio_"+t.question.id),i.Db(1),i.nc("src",i.ic(2,2,i.ic(3,4,t.question.attachments[0].url)),i.Hc)}}function O(t,e){if(1&t&&(i.Vb(0,"div",17),i.Pc(1,y,4,6,"audio",18),i.Ub()),2&t){const t=i.gc(3);i.Db(1),i.nc("ngIf","mp3"==t.question.attachments[0].extension)}}function P(t,e){if(1&t&&(i.Vb(0,"div",3),i.Pc(1,_,6,4,"div",4),i.Pc(2,O,2,1,"div",5),i.Ub()),2&t){const t=e.$implicit,n=i.gc(2);i.Db(1),i.nc("ngIf",t.url&&""!=t.url),i.Db(1),i.nc("ngIf",n.question.attachments&&n.question.attachments.length>0)}}function k(t,e){if(1&t&&(i.Vb(0,"div",1),i.Pc(1,P,3,2,"div",2),i.Ub()),2&t){const t=i.gc();i.oc("id","media_content_"+t.question.id),i.Db(1),i.nc("ngForOf",t.question.questionContent)}}let D=(()=>{class t{constructor(t,e,n,i,s){this.activeRoute=t,this.router=e,this.commonService=n,this.localize=i,this.apiService=s,this.question={},this.examConfig={},this.index=0,this.examObj={},this.firstInGroupIndexes=[]}resizeImg(t,e,n){var i=document.getElementById("media_content_"+t),s=null==i?void 0:i.offsetWidth;return i?s/e<=1?Math.round(n*(s/e)):Math.round(n):0}checkHiddenGroup(t,e){return t?!t.includes(e):!this.firstInGroupIndexes.includes(e)}ngOnInit(){this.firstInGroupIndexes=this.commonService.parseJson(this.examObj.firstInGroupIndexes)}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.a),i.Pb(o.i),i.Pb(c.a),i.Pb(r.e),i.Pb(l.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["azt-question-pdf-item"]],inputs:{question:"question",examConfig:"examConfig",index:"index",examObj:"examObj"},decls:1,vars:1,consts:[["class","question-card mb-0 p-2",3,"id",4,"ngIf"],[1,"question-card","mb-0","p-2",3,"id"],["class","card-body pt-1 pb-1 pl-0 pr-0 MW-800",4,"ngFor","ngForOf"],[1,"card-body","pt-1","pb-1","pl-0","pr-0","MW-800"],[4,"ngIf"],["class","text-center ml-auto mr-auto",4,"ngIf"],["class","image_group mb-3",3,"hidden",4,"ngIf"],["class","embed-responsive embed-responsive-21by9",4,"ngIf"],["originalRender",""],[4,"ngIf","ngIfElse"],[1,"image_group","mb-3",3,"hidden"],["appImageFallback","","alt","",2,"max-width","100%",3,"src"],[1,"embed-responsive","embed-responsive-21by9"],[1,"embed-responsive-item",3,"src"],[3,"id","imgSrc",4,"ngIf"],[3,"id","imgSrc"],["alt","question media",3,"id","src"],[1,"text-center","ml-auto","mr-auto"],["class","audio_src","controls","","preload","true",3,"id",4,"ngIf"],["controls","","preload","true",1,"audio_src",3,"id"],[3,"src"]],template:function(t,e){1&t&&i.Pc(0,k,2,2,"div",0),2&t&&i.nc("ngIf",e.question.questionContent&&e.question.questionContent.length>0)},directives:[h.m,h.l,m.a,b.a],pipes:[g.n,g.r],styles:[".question-card[_ngcontent-%COMP%]{box-shadow:none}.audio_src[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px;max-width:70%}"]}),t})();function C(t,e){if(1&t&&(i.Vb(0,"div",10),i.Vb(1,"span",11),i.Rc(2),i.Ub(),i.Rc(3,"\xa0"),i.Qb(4,"div",6),i.Ub()),2&t){const t=e.$implicit;i.Db(2),i.Tc("",t.alpha?t.alpha:t.key,"."),i.Db(2),i.nc("innerHtml",t.content,i.Ec)}}function I(t,e){if(1&t&&(i.Vb(0,"audio",14),i.Qb(1,"source",15),i.hc(2,"safe"),i.hc(3,"mycdn"),i.Ub()),2&t){const t=i.gc(2);i.oc("id","audio_"+t.question.id),i.Db(1),i.nc("src",i.ic(2,2,i.ic(3,4,t.question.attachments[0].url)),i.Hc)}}function M(t,e){if(1&t&&(i.Vb(0,"div",12),i.Pc(1,I,4,6,"audio",13),i.Ub()),2&t){const t=i.gc();i.Db(1),i.nc("ngIf","mp3"==t.question.attachments[0].extension)}}let q=(()=>{class t{constructor(t,e,n,i,s){this.activeRoute=t,this.router=e,this.commonService=n,this.localize=i,this.apiService=s,this.index=0,this.question={}}ngOnInit(){}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.a),i.Pb(o.i),i.Pb(c.a),i.Pb(r.e),i.Pb(l.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["azt-question-docx-item"]],inputs:{index:"index",question:"question"},decls:12,vars:6,consts:[[1,"question-card","question-docx","mb-0","p-2",3,"id"],[1,"content_dx_wrap"],[1,"docx-stt"],[1,"stt",2,"width","105px"],["matTooltip","\u0110i\u1ec3m t\u1ed1i \u0111a cho c\xe2u h\u1ecfi n\xe0y (theo thang \u0111i\u1ec3m)",1,"maxPoint"],[1,"contentDocx"],[3,"innerHtml"],[1,"row","mt-1","justify-content-around"],["class","col-sm-6 col-md-6 d-flex align-items-center",4,"ngFor","ngForOf"],["class","text-center ml-auto mr-auto",4,"ngIf"],[1,"col-sm-6","col-md-6","d-flex","align-items-center"],[2,"vertical-align","middle"],[1,"text-center","ml-auto","mr-auto"],["class","audio_src","controls","","preload","true",3,"id",4,"ngIf"],["controls","","preload","true",1,"audio_src",3,"id"],[3,"src"]],template:function(t,e){1&t&&(i.Vb(0,"div",0),i.Vb(1,"div",1),i.Vb(2,"p",2),i.Vb(3,"span",3),i.Rc(4),i.Vb(5,"span",4),i.Rc(6),i.Ub(),i.Ub(),i.Ub(),i.Vb(7,"div",5),i.Qb(8,"div",6),i.Ub(),i.Vb(9,"div",7),i.Pc(10,C,5,2,"div",8),i.Ub(),i.Ub(),i.Pc(11,M,2,1,"div",9),i.Ub()),2&t&&(i.oc("id","media_content_"+e.question.id),i.Db(4),i.Tc("C\xe2u ",e.question.indexLabel+1," "),i.Db(2),i.Tc("(",e.question.essMaxPoint," \u0111i\u1ec3m)"),i.Db(2),i.nc("innerHtml",e.question.questionContent[0].content,i.Ec),i.Db(2),i.nc("ngForOf",e.question.answerConfig),i.Db(1),i.nc("ngIf",e.question.attachments&&e.question.attachments.length>0))},directives:[d.a,h.l,h.m],pipes:[g.r,g.n],styles:[".question-card[_ngcontent-%COMP%]{box-shadow:none}.content_dx_wrap[_ngcontent-%COMP%]{padding:5px 15px}.docx-stt[_ngcontent-%COMP%]{font-weight:450;font-size:16px}.audio_src[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px;max-width:70%}"]}),t})();var S=n("NFeN");function j(t,e){1&t&&(i.Vb(0,"mat-icon",12),i.Rc(1,"close"),i.Ub())}function R(t,e){if(1&t&&i.Pc(0,j,2,0,"mat-icon",11),2&t){const t=i.gc().$implicit,e=i.gc(3);i.nc("ngIf",e.isChosen(t))}}function T(t,e){1&t&&(i.Vb(0,"mat-icon",13),i.Rc(1,"check_circle"),i.Ub())}function U(t,e){if(1&t&&(i.Vb(0,"div",8),i.Pc(1,R,1,1,"ng-template",2),i.Pc(2,T,2,0,"mat-icon",9),i.Vb(3,"span",10),i.Rc(4),i.Ub(),i.Ub()),2&t){const t=e.$implicit,n=i.gc(3);i.Db(1),i.nc("ngIf",!(n.isKey(t)&&n.isChosen(t))),i.Db(1),i.nc("ngIf",n.isKey(t)&&n.isChosen(t)),i.Db(2),i.Tc(" ",t.alpha?t.alpha:t.key?t.key:t," ")}}const L=function(t){return{color:t}},E=function(t){return{"border-color":t}};function A(t,e){if(1&t&&(i.Vb(0,"div",4),i.Vb(1,"span",5),i.Rc(2),i.Ub(),i.Vb(3,"div",6),i.Pc(4,U,5,3,"div",7),i.Ub(),i.Ub()),2&t){const t=i.gc(2);i.Db(1),i.nc("ngStyle",i.sc(4,L,t.userAnswersObj["id_"+t.question.id]==t.question.answerResult[0]?"#00ac33":"red")),i.Db(1),i.Tc("\u0110\xe1p \xe1n \u0111\xfang: ",t.key,""),i.Db(1),i.nc("ngStyle",i.sc(6,E,t.userAnswersObj["id_"+t.question.id]==t.question.answerResult[0]?"#00ac33":"red")),i.Db(1),i.nc("ngForOf",t.labelArr)}}function V(t,e){if(1&t&&(i.Vb(0,"span",5),i.Rc(1),i.Ub()),2&t){const t=i.gc(3);i.nc("ngStyle",i.sc(2,L,t.isFillAnswer?"#00ac33":"red")),i.Db(1),i.Tc("\u0110\xe1p \xe1n \u0111\xfang: [",t.keys.join("],["),"]")}}function B(t,e){if(1&t&&(i.Vb(0,"div",4),i.Pc(1,V,2,4,"span",14),i.Vb(2,"div",15),i.Vb(3,"div",16),i.Rc(4),i.Ub(),i.Ub(),i.Ub()),2&t){const t=i.gc(2);i.Db(1),i.nc("ngIf",t.keys),i.Db(1),i.nc("ngStyle",i.sc(3,E,t.isFillAnswer?"#00ac33":"00ac33")),i.Db(2),i.Tc(" ",t.userAnswersObj["id_"+t.question.id]?t.userAnswersObj["id_"+t.question.id]:"Th\xed sinh kh\xf4ng nh\u1eadp th\xf4ng tin"," ")}}function Q(t,e){if(1&t&&(i.Vb(0,"div"),i.Pc(1,A,5,8,"div",3),i.Pc(2,B,5,5,"div",3),i.Ub()),2&t){const t=i.gc();i.Db(1),i.nc("ngIf",1==t.question.answerType),i.Db(1),i.nc("ngIf",4==t.question.answerType)}}function z(t,e){if(1&t&&(i.Vb(0,"span",5),i.Rc(1),i.Ub()),2&t){const t=i.gc(3);i.nc("ngStyle",i.sc(2,L,t.userAnswersObj["id_"+t.question.id]==t.question.answerResult[0]?"#00ac33":"red")),i.Db(1),i.Tc("\u0110\xe1p \xe1n \u0111\xfang: ",t.key,"")}}function F(t,e){1&t&&i.Qb(0,"span",19)}function N(t,e){1&t&&(i.Vb(0,"mat-icon",12),i.Rc(1,"close"),i.Ub())}function W(t,e){if(1&t&&i.Pc(0,N,2,0,"mat-icon",11),2&t){const t=i.gc().$implicit,e=i.gc(3);i.nc("ngIf",e.isChosen(t)&&2!=e.examConfig.whenShowAnswer)}}function J(t,e){1&t&&(i.Vb(0,"mat-icon"),i.Rc(1,"check_circle"),i.Ub())}function H(t,e){if(1&t&&i.Pc(0,J,2,0,"mat-icon",0),2&t){const t=i.gc().$implicit,e=i.gc(3);i.nc("ngIf",e.isChosen(t)&&2==e.examConfig.whenShowAnswer)}}function $(t,e){1&t&&(i.Vb(0,"mat-icon",13),i.Rc(1,"check_circle"),i.Ub())}function G(t,e){if(1&t&&(i.Vb(0,"div",8),i.Pc(1,W,1,1,"ng-template",2),i.Pc(2,H,1,1,"ng-template",2),i.Pc(3,$,2,0,"mat-icon",9),i.Vb(4,"span",10),i.Rc(5),i.Ub(),i.Ub()),2&t){const t=e.$implicit,n=i.gc(3);i.Db(1),i.nc("ngIf",!(n.isKey(t)&&n.isChosen(t))),i.Db(1),i.nc("ngIf",!(n.isKey(t)&&n.isChosen(t))),i.Db(1),i.nc("ngIf",n.isKey(t)&&n.isChosen(t)&&2!=n.examConfig.whenShowAnswer),i.Db(2),i.Tc(" ",t.alpha?t.alpha:t.key?t.key:t," ")}}function K(t,e){if(1&t&&(i.Vb(0,"div",4),i.Pc(1,z,2,4,"span",14),i.Pc(2,F,1,0,"span",17),i.Vb(3,"div",18),i.Pc(4,G,6,4,"div",7),i.Ub(),i.Ub()),2&t){const t=i.gc(2);i.Db(1),i.nc("ngIf",2!=t.examConfig.whenShowAnswer),i.Db(1),i.nc("ngIf",t.keys&&2==t.examConfig.whenShowAnswer),i.Db(2),i.nc("ngForOf",t.labelArr)}}function X(t,e){if(1&t&&(i.Vb(0,"span",5),i.Rc(1),i.Ub()),2&t){const t=i.gc(3);i.nc("ngStyle",i.sc(2,L,t.isFillAnswer?"#00ac33":"red")),i.Db(1),i.Tc("\u0110\xe1p \xe1n \u0111\xfang: [",t.keys.join("],["),"]")}}function Y(t,e){1&t&&i.Qb(0,"span",19)}function Z(t,e){if(1&t&&(i.Vb(0,"div",4),i.Pc(1,X,2,4,"span",14),i.Pc(2,Y,1,0,"span",17),i.Vb(3,"div",18),i.Vb(4,"div",16),i.Rc(5),i.Ub(),i.Ub(),i.Ub()),2&t){const t=i.gc(2);i.Db(1),i.nc("ngIf",t.keys&&2!=t.examConfig.whenShowAnswer),i.Db(1),i.nc("ngIf",t.keys&&2==t.examConfig.whenShowAnswer),i.Db(3),i.Tc(" ",t.userAnswersObj["id_"+t.question.id]?t.userAnswersObj["id_"+t.question.id]:"Th\xed sinh kh\xf4ng nh\u1eadp th\xf4ng tin"," ")}}function tt(t,e){if(1&t&&(i.Vb(0,"div"),i.Pc(1,K,5,3,"div",3),i.Pc(2,Z,6,3,"div",3),i.Ub()),2&t){const t=i.gc();i.Db(1),i.nc("ngIf",1==t.question.answerType),i.Db(1),i.nc("ngIf",4==t.question.answerType)}}function et(t,e){1&t&&i.Qb(0,"div",20)}function nt(t,e){if(1&t&&(i.Qb(0,"div",23),i.hc(1,"formatLineBreak")),2&t){const t=i.gc(2);i.nc("innerHtml","multiple_choice"==t.place?"Xem th\xf4ng tin \u1edf tab t\u1ef1 lu\u1eadn":""!=t.userAnswersObj["id_"+t.question.id]&&t.userAnswersObj["id_"+t.question.id]?i.ic(1,1,t.userAnswersObj["id_"+t.question.id]):"Th\xed sinh kh\xf4ng nh\u1eadp th\xf4ng tin.",i.Ec)}}function it(t,e){if(1&t&&(i.Qb(0,"div",24),i.hc(1,"formatLineBreak")),2&t){const t=i.gc(2);i.nc("innerHtml",""!=t.userAnswersObj["id_"+t.question.id]&&t.userAnswersObj["id_"+t.question.id]?i.ic(1,1,t.userAnswersObj["id_"+t.question.id]):"Th\xed sinh kh\xf4ng nh\u1eadp th\xf4ng tin.",i.Ec)}}function st(t,e){if(1&t&&(i.Pc(0,nt,2,3,"div",21),i.Pc(1,it,2,3,"div",22)),2&t){const t=i.gc();i.nc("ngIf",3==t.question.answerType),i.Db(1),i.nc("ngIf",3==t.question.answerType)}}const at=["*"];let ot=(()=>{class t{constructor(t,e,n,s,a){this.activeRoute=t,this.router=e,this.commonService=n,this.localize=s,this.apiService=a,this.userAnswersObj={},this.question={},this.examConfig={},this.place="multiple_choice",this.statusResult=new i.o,this.key="",this.keys=[],this.labelArr=[],this.isFillAnswer=!1}showExplainQuestion(t){}isKey(t){return!!this.question.answerResult&&(t.key?t.key==this.question.answerResult[0]:t==this.question.answerResult[0])}isChosen(t){return!!this.userAnswersObj["id_"+this.question.id]&&(t.key?t.key.toString()==this.userAnswersObj["id_"+this.question.id]:t.toString()==this.userAnswersObj["id_"+this.question.id])}findKey(){if(this.question.answerResult)for(let t=0;t<this.labelArr.length;t++)if(this.question.answerResult[0]==this.labelArr[t].key&&this.labelArr[t].alpha){this.key=this.labelArr[t].alpha;break}}actionIsFillAnswer(t){return void 0!==t&&!!this.userAnswersObj["id_"+this.question.id]&&(this.userAnswersObj["id_"+this.question.id]=this.userAnswersObj["id_"+this.question.id].replace(/\n+/g,"\u21b5"),this.commonService.funcConvertFillAns(t.toString())===this.commonService.funcConvertFillAns(this.userAnswersObj["id_"+this.question.id]))}ngOnInit(){if(this.isFillAnswer=!1,this.question.answerResult&&(this.key=this.question.answerResult[0]),1!=this.question.isImage||this.question.name.startsWith("[PDFv2]")||(this.labelArr=this.question.answerConfig.answer),(0==this.question.isImage||this.question.name.startsWith("[PDFv2]"))&&(this.labelArr=this.question.answerConfig,this.findKey()),1===this.question.answerType)for(let t=0;t<this.labelArr.length&&(this.isFillAnswer=this.isKey(this.labelArr[t])&&this.isChosen(this.labelArr[t]),!0!==this.isFillAnswer);t++);if(4===this.question.answerType&&this.question.answerResult&&this.question.answerResult.length>0){this.keys=this.question.answerResult;for(let t=0;t<this.keys.length;t++)if(this.actionIsFillAnswer(this.keys[t])){this.isFillAnswer=!0;break}}this.statusResult.emit(this.isFillAnswer)}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.a),i.Pb(o.i),i.Pb(c.a),i.Pb(r.e),i.Pb(l.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["azt-answer-box"]],inputs:{userAnswersObj:"userAnswersObj",question:"question",examConfig:"examConfig",place:"place"},outputs:{statusResult:"statusResult"},ngContentSelectors:at,decls:5,vars:4,consts:[[4,"ngIf"],["class","answer-box answer-box-type2 ml-auto",4,"ngIf"],[3,"ngIf"],["class","answer-box-type1 row pl-0 pr-0 ml-0 mr-0",4,"ngIf"],[1,"answer-box-type1","row","pl-0","pr-0","ml-0","mr-0"],[1,"keyText","my-1",3,"ngStyle"],[1,"answer-box","ml-auto","my-1",3,"ngStyle"],["class","label-item",4,"ngFor","ngForOf"],[1,"label-item"],["style","color: #00ac33;",4,"ngIf"],[1,"lalala"],["style","color: red;",4,"ngIf"],[2,"color","red"],[2,"color","#00ac33"],["class","keyText my-1",3,"ngStyle",4,"ngIf"],[1,"answer-box","ml-auto","my-1",2,"padding","0",3,"ngStyle"],[1,"text-answer"],["class","keyText my-1 ml-2",4,"ngIf"],[1,"answer-box","ml-auto","my-1",2,"border-color","00ac33"],[1,"keyText","my-1","ml-2"],[1,"answer-box","answer-box-type2","ml-auto"],["class","answer-box answer-box-type3 ml-auto notForPdfExport",3,"innerHtml",4,"ngIf"],["class","answer-box answer-box-type3 ml-auto forPdfExport",3,"innerHtml",4,"ngIf"],[1,"answer-box","answer-box-type3","ml-auto","notForPdfExport",3,"innerHtml"],[1,"answer-box","answer-box-type3","ml-auto","forPdfExport",3,"innerHtml"]],template:function(t,e){1&t&&(i.mc(),i.lc(0),i.Pc(1,Q,3,2,"div",0),i.Pc(2,tt,3,2,"div",0),i.Pc(3,et,1,0,"div",1),i.Pc(4,st,2,2,"ng-template",2)),2&t&&(i.Db(1),i.nc("ngIf",e.examConfig.isRoleTeacher),i.Db(1),i.nc("ngIf",!e.examConfig.isRoleTeacher),i.Db(1),i.nc("ngIf",2==e.question.answerType),i.Db(1),i.nc("ngIf",""!=e.userAnswersObj["id_"+e.question.id]||e.userAnswersObj["id_"+e.question.id]))},directives:[h.m,h.n,h.l,S.a],pipes:[g.k],styles:[".answer-box-type1[_ngcontent-%COMP%]{display:flex;align-items:center}.answer-box-type1[_ngcontent-%COMP%]   .keyText[_ngcontent-%COMP%]{font-weight:500;font-size:18px;flex:auto;text-align:right;margin-right:15px}.answer-box[_ngcontent-%COMP%]{width:300px;display:flex;justify-content:space-between;background-color:#f7f7f7;padding:10px;border:1px solid #f1f1f1;border-radius:3px}.answer-box[_ngcontent-%COMP%]   .label-item[_ngcontent-%COMP%]{font-weight:500;display:flex;align-items:center;font-size:18px;width:40px;justify-content:flex-end}.answer-box.answer-box-type3[_ngcontent-%COMP%]{width:100%}.text-answer[_ngcontent-%COMP%]{width:100%;min-height:40px;max-height:120px;overflow:auto;padding:10px}textarea[_ngcontent-%COMP%]:focus{border:none!important}.forPdfExport[_ngcontent-%COMP%]{display:none}.ans-4[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical}@media screen and (max-width:480px){.answer-box[_ngcontent-%COMP%]{width:auto}.text-answer[_ngcontent-%COMP%]{width:180px;max-height:auto}}"]}),t})();function ct(t,e){if(1&t&&(i.Vb(0,"div",3),i.Qb(1,"azt-loaded-img",4),i.hc(2,"mycdn"),i.Ub()),2&t){const t=i.gc();i.Db(1),i.nc("imgSrc",i.ic(2,1,t.question.answerMedia))}}function rt(t,e){if(1&t&&i.Qb(0,"div",5),2&t){const t=i.gc();i.nc("innerHtml",t.question.answerMedia,i.Ec)}}let lt=(()=>{class t{constructor(t,e,n,i,s){this.activeRoute=t,this.router=e,this.commonService=n,this.localize=i,this.apiService=s,this.question={}}ngOnInit(){}ngOnchanges(){}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.a),i.Pb(o.i),i.Pb(c.a),i.Pb(r.e),i.Pb(l.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["azt-explain-box"]],inputs:{question:"question"},decls:3,vars:3,consts:[[1,"alert","alert-info",3,"id"],["style"," width: 100%; overflow: auto; ",4,"ngIf"],["style"," width: 100%; overflow: auto; ",3,"innerHtml",4,"ngIf"],[2,"width","100%","overflow","auto"],[3,"imgSrc"],[2,"width","100%","overflow","auto",3,"innerHtml"]],template:function(t,e){1&t&&(i.Vb(0,"div",0),i.Pc(1,ct,3,3,"div",1),i.Pc(2,rt,1,1,"div",2),i.Ub()),2&t&&(i.oc("id","explain_"+e.question.id),i.Db(1),i.nc("ngIf",1==e.question.isImage),i.Db(1),i.nc("ngIf",0==e.question.isImage))},directives:[h.m,b.a],pipes:[g.n],styles:[""]}),t})();function ut(t,e){if(1&t){const t=i.Wb();i.Vb(0,"div",7),i.cc("click",function(){return i.Dc(t),i.gc().handleSelectQuestion()}),i.Rc(1," H\u1ecfi gi\xe1o vi\xean "),i.Ub()}}function ht(t,e){if(1&t&&i.Qb(0,"azt-question-pdf-item",8),2&t){const t=i.gc();i.nc("examConfig",t.examConfig)("question",t.question)("examObj",t.examObj)("index",t.index)}}function dt(t,e){if(1&t&&i.Qb(0,"azt-question-docx-item",9),2&t){const t=i.gc();i.nc("question",t.question)("index",t.index)}}const mt=function(t){return{width:t}};function bt(t,e){if(1&t){const t=i.Wb();i.Vb(0,"span",12),i.cc("click",function(){return i.Dc(t),i.gc(2).showExplain()}),i.Rc(1," Gi\u1ea3i th\xedch "),i.Vb(2,"mat-icon"),i.Rc(3),i.Ub(),i.Ub()}if(2&t){const t=i.gc(2);i.nc("ngStyle",i.sc(3,mt,""==t.question.answerMedia?"0px":"125px")),i.Eb("style",t.question.answerMedia||""!=t.question.answerMedia?"visibility:  visible !important":"visibility:  hidden !important",i.Gc),i.Db(3),i.Sc(t.isShowExplain?"expand_less":"expand_more")}}const gt=function(t){return{"justify-content":t}};function pt(t,e){if(1&t){const t=i.Wb();i.Vb(0,"azt-answer-box",10),i.cc("statusResult",function(e){return i.Dc(t),i.gc().returnStatusResult(e)}),i.Pc(1,bt,4,5,"span",11),i.Ub()}if(2&t){const t=i.gc();i.nc("question",t.question)("userAnswersObj",t.userAnswersObj)("place",t.place)("examConfig",t.examConfig)("ngStyle",i.sc(6,gt,2==t.configExam.whenShowAnswer?"flex-end":"space-between")),i.Db(1),i.nc("ngIf",2!=t.configExam.whenShowAnswer)}}const ft=function(t,e){return{width:t,visibility:e}};function xt(t,e){if(1&t){const t=i.Wb();i.Vb(0,"azt-answer-box",13),i.cc("statusResult",function(e){return i.Dc(t),i.gc().returnStatusResult(e)}),i.Vb(1,"span",12),i.cc("click",function(){return i.Dc(t),i.gc().showExplain()}),i.Rc(2," Gi\u1ea3i th\xedch "),i.Vb(3,"mat-icon"),i.Rc(4),i.Ub(),i.Ub(),i.Ub()}if(2&t){const t=i.gc();i.nc("question",t.question)("userAnswersObj",t.userAnswersObj)("place",t.place)("examConfig",t.examConfig),i.Db(1),i.nc("ngStyle",i.tc(6,ft,""==t.question.answerMedia?"0px":"125px",t.question.answerMedia||""!=t.question.answerMedia?"visible":"hidden")),i.Db(3),i.Sc(t.isShowExplain?"expand_less":"expand_more")}}function vt(t,e){if(1&t&&i.Qb(0,"azt-explain-box",14),2&t){const t=i.gc();i.nc("question",t.question)}}const wt=function(t,e){return{border:t,"margin-bottom":e}};let _t=(()=>{class t{constructor(t,e,n,a,o,c){this.activeRoute=t,this.router=e,this.commonService=n,this.localize=a,this.apiService=o,this.store=c,this.question={},this.examObj={},this.userAnswersObj={},this.configExam={},this.index=0,this.isDisplayInExportMode=!1,this.place="multiple_choice",this.statusResult=new i.o,this.isShowExplain=!1,this.examConfig={},this.subscription=new s.a}showExplain(){this.isShowExplain=!this.isShowExplain}checkResultAns(){}returnStatusResult(t){this.statusResult.emit(t)}handleSelectQuestion(){let t=document.getElementById("question_item_box_"+this.question.id),e=null==t?void 0:t.querySelector("img.questionId_"+this.question.id);this.store.dispatch(a.b({question:{data:{id:this.question.id},url:e?e.src:"",stt:this.index}})),this.store.dispatch(a.a({selectTest:{id:this.examObj.id,name:this.examObj.name},resultId:this.cur_result}));let n={};n.tenantId=this.activeRoute.snapshot.paramMap.get("tenant_id"),n.cate_id=this.activeRoute.snapshot.paramMap.get("cate_id"),n.hashId=this.activeRoute.snapshot.paramMap.get("hash_id"),n.resultId=this.activeRoute.snapshot.paramMap.get("result_id"),this.commonService.myNavigation(`/student-qa/create-question/${n.tenantId}/${n.cate_id}/${n.hashId}/${n.resultId}`)}isChecked(t){return!!this.state.tbFront.selectedQuestion&&this.state.tbFront.selectedQuestion.data.id==t}ngOnInit(){this.examConfig=this.configExam,this.examConfig.isRoleTeacher=this.question.isRoleTeacher,this.isDisplayInExportMode&&(this.examConfig.isRoleTeacher=!0),this.subscription.add(this.store.subscribe(t=>{this.state=t}))}ngOnDestroy(){this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.a),i.Pb(o.i),i.Pb(c.a),i.Pb(r.e),i.Pb(l.a),i.Pb(u.h))},t.\u0275cmp=i.Jb({type:t,selectors:[["azt-question-item"]],inputs:{isBackEnd:"isBackEnd",question:"question",cur_result:"cur_result",examObj:"examObj",userAnswersObj:"userAnswersObj",configExam:"configExam",index:"index",isDisplayInExportMode:"isDisplayInExportMode",place:"place"},outputs:{statusResult:"statusResult"},decls:7,vars:11,consts:[[1,"question-item-box",3,"ngStyle","id"],["matTooltip","\u0110\u1eb7t c\xe2u h\u1ecfi cho gi\xe1o vi\xean v\u1ec1 c\xe2u h\u1ecfi n\xe0y","class","selectToAsk clickable",3,"click",4,"ngIf"],[3,"examConfig","question","examObj","index",4,"ngIf"],[3,"question","index",4,"ngIf"],["style","padding-right: 20px;  padding-left: 20px;",3,"question","userAnswersObj","place","examConfig","ngStyle","statusResult",4,"ngIf"],["style","padding-right: 20px; padding-left: 20px;",3,"question","userAnswersObj","place","examConfig","statusResult",4,"ngIf"],[3,"question",4,"ngIf"],["matTooltip","\u0110\u1eb7t c\xe2u h\u1ecfi cho gi\xe1o vi\xean v\u1ec1 c\xe2u h\u1ecfi n\xe0y",1,"selectToAsk","clickable",3,"click"],[3,"examConfig","question","examObj","index"],[3,"question","index"],[2,"padding-right","20px","padding-left","20px",3,"question","userAnswersObj","place","examConfig","ngStyle","statusResult"],["class","explainTxt clickable",3,"ngStyle","click",4,"ngIf"],[1,"explainTxt","clickable",3,"ngStyle","click"],[2,"padding-right","20px","padding-left","20px",3,"question","userAnswersObj","place","examConfig","statusResult"],[3,"question"]],template:function(t,e){1&t&&(i.Vb(0,"div",0),i.Pc(1,ut,2,0,"div",1),i.Pc(2,ht,1,4,"azt-question-pdf-item",2),i.Pc(3,dt,1,2,"azt-question-docx-item",3),i.Pc(4,pt,2,8,"azt-answer-box",4),i.Pc(5,xt,5,9,"azt-answer-box",5),i.Pc(6,vt,1,1,"azt-explain-box",6),i.Ub()),2&t&&(i.nc("ngStyle",i.tc(8,wt,1!=e.question.isImage||e.isBackEnd?"none":"1px solid rgb(241 241 241)",1!=e.question.isImage||e.isBackEnd?0:"10px"))("id","question_item_box_"+e.question.id),i.Db(1),i.nc("ngIf",1==e.question.isImage&&!e.isBackEnd),i.Db(1),i.nc("ngIf",1==e.question.isImage),i.Db(1),i.nc("ngIf",0==e.question.isImage),i.Db(1),i.nc("ngIf",!e.question.isRoleTeacher),i.Db(1),i.nc("ngIf",e.question.isRoleTeacher),i.Db(1),i.nc("ngIf",e.isShowExplain))},directives:[h.n,h.m,d.a,D,q,ot,S.a,lt],styles:["azt-answer-box[_ngcontent-%COMP%]{justify-content:space-between;margin-bottom:10px}.explainTxt[_ngcontent-%COMP%], azt-answer-box[_ngcontent-%COMP%]{display:flex;align-items:center}.explainTxt[_ngcontent-%COMP%]{width:125px;color:#42aba2;font-weight:500}.question-item-box[_ngcontent-%COMP%]{display:block;position:relative}.question-item-box[_ngcontent-%COMP%]   .selectToAsk[_ngcontent-%COMP%]{position:absolute;top:-1px;right:-1px;padding:5px;color:#fff;background-color:rgba(255,166,0,.747)}"]}),t})()},s65G:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n("mrSG"),s=n("quSY"),a=n("fXoL"),o=n("gbi4"),c=n("yTNM");let r=(()=>{class t{constructor(t,e){this.commonService=t,this.apiService=e,this.labelsImg=new Image,this.questionLabelMap=[],this.abcdLabelPos={},this.subscription=new s.a,this.drawMixQuestion=(t,e,n)=>Object(i.a)(this,void 0,void 0,function*(){this.questionLabelMap=e[0].questionContent[0].questionLabelMap?e[0].questionContent[0].questionLabelMap:this.commonService.parseJson(n.questionLabelMap),this.abcdLabelPos=e[0].questionContent[0].abcdLabelPos?e[0].questionContent[0].abcdLabelPos:this.commonService.parseJson(n.abcdLabelPos);const s={width:1,height:1,top:1,left:1};e.forEach(t=>{1==t.isImage&&(t.mixDataImg="https://cdn.jsdelivr.net/gh/azota889/storage_public/azota_assets/svgs/Img2_dat-01.svg",t.answerLabelsMockup={"label-A":s,"label-B":s,"label-C":s,"label-D":s,"label-E":s,"label-F":s})}),this.labelsImg.crossOrigin="anonymous",this.labelsImg.onload=()=>Object(i.a)(this,void 0,void 0,function*(){let t=[],n=[];for(let i=0;i<e.length;i++)n.push({originalIndex:i,question:e[i]}),5!=n.length&&i!=e.length-1||(t.push(n),n=[]);const s=t=>Object(i.a)(this,void 0,void 0,function*(){for(let n=0;n<t.length;n++)1==t[n].question.isImage&&(1==t[n].question.answerType?this.prepareImageToDrawForType1(t[n].question.answerConfig,t[n].question.questionContent[0],t[n].originalIndex,e):this.prepareImageForOtherTypes(t[n].question.questionContent[0],t[n].originalIndex,e));return new Promise(function(t,e){setTimeout(t,3e3)}).then(function(){console.log("Start process next chunk!")})});for(const e of t)yield s(e)}),this.makeRetry(this.labelsImg,3,2e3),this.labelsImg.src=this.commonService.getMyCdn(t)})}cancelSubscription(){this.subscription.unsubscribe()}makeRetry(t,e,n,i,s,a,o,c){t.crossOrigin="anonymous",t.setAttribute("totalRetry","0"),t.onerror=()=>{let r=parseInt(t.getAttribute("totalRetry"));if(r++,r<=e)setTimeout(()=>{if(r>Math.floor(e/2))t.src=this.commonService.getRawCdnLink(t.src);else{let e=t.src.split("?")[0];t.src=e+"?t="+Date.now()}t.setAttribute("totalRetry",r.toString())},n);else{var l,u;try{l=(u=localStorage.getItem("user_obj"))?JSON.parse(u).id:"unknown"}catch(h){l="browser_not_local_storage"}let e=document.URL.split("?")[0].split("/"),n={userId:l,trackKey:"V2_ERR_DISPLAY",name:"Track l\u1ed7i kh\xf4ng hi\u1ec3n th\u1ecb c\xe2u h\u1ecfi v2",userAgent:navigator.userAgent,content:t.src,url:document.URL,error:e[e.length-1]};if(this.subscription.add(this.apiService.saveTrackLog(n).subscribe(t=>{console.log("Track l\u1ed7i th\xe0nh c\xf4ng!")})),(i||0===i)&&s&&a&&o){o[i].mixDataImg="https://cdn.jsdelivr.net/gh/azota889/storage_public/azota_assets/svgs/Img_dat-01.svg";let t=document.getElementById("questionPlaceholder_"+i);null==t||t.setAttribute("loadSuccess","0");let e=document.getElementById("media_content_all_"+o[i].id);null==e||e.setAttribute("loadSuccess","0");const n=t=>{"0"===(null==t?void 0:t.getAttribute("loadSuccess"))&&(c?this.prepareImageForOtherTypes(a,i,o):this.prepareImageToDrawForType1(s,a,i,o))};e?e.onclick=()=>{n(e)}:t&&(t.onclick=()=>{n(t)})}}}}prepareImageToDrawForType1(t,e,n,i){let s=1+t.length,a=0,o=new Image;o.crossOrigin="anonymous",o.onload=()=>{a++,a==s&&this.drawEachQuestion(t,e,n,o,c,i)},this.makeRetry(o,3,1e3,n,t,e,i),o.src=this.commonService.getMyCdn(e.metaData.question.url);let c=[];for(let r=0;r<t.length;r++)c[r]=new Image,c[r].crossOrigin="anonymous",c[r].onload=()=>{a++,a==s&&this.drawEachQuestion(t,e,n,o,c,i)},this.makeRetry(c[r],3,1e3,n,t,e,i),c[r].src=this.commonService.getMyCdn(t[r].content)}prepareImageForOtherTypes(t,e,n){let i=document.createElement("canvas");i.width=t.metaData.question.width+10,i.height=t.metaData.question.height;let s=i.getContext("2d"),a=new Image;a.crossOrigin="anonymous",a.onload=()=>{null==s||s.drawImage(a,10,0),null==s||s.drawImage(this.labelsImg,this.questionLabelMap[e].left,this.questionLabelMap[e].top,this.questionLabelMap[e].width,this.questionLabelMap[e].height,t.metaData.question.remove.x,t.metaData.question.remove.y,this.questionLabelMap[e].width,this.questionLabelMap[e].height),n[e].mixDataImg=i.toDataURL("image/png")},this.makeRetry(a,3,1e3,void 0,void 0,void 0,void 0,"others"),a.src=this.commonService.getMyCdn(t.metaData.question.url)}drawEachQuestion(t,e,n,i,s,a){let o=document.createElement("canvas");o.width=e.metaData.question.width+15,o.height=e.metaData.question.height;let c=o.getContext("2d");null==c||c.drawImage(i,15,0),null==c||c.drawImage(this.labelsImg,this.questionLabelMap[n].left,this.questionLabelMap[n].top,this.questionLabelMap[n].width,this.questionLabelMap[n].height,e.metaData.question.remove.x,e.metaData.question.remove.y,this.questionLabelMap[n].width,this.questionLabelMap[n].height);let r=s[0],l=0,u=0,h=0,d=e.metaData.answers[0].x,m=e.metaData.answers[0].y;l=d,u=d+r.width,h=d+r.width;let b=s[0].height-e.metaData.answers[0].height;null==c||c.drawImage(r,d,m);let g=t[0].alpha?t[0].alpha:t[0].key,p=0;if(t[0].alpha){let e=t[0].key;for(let n=0;n<t.length;n++)if(e==t[n].alpha){p=n;break}}let f={left:void 0!==e.metaData.answers[p].remove.xAns?d+e.metaData.answers[p].remove.xAns:e.metaData.answers[0].remove.x,top:void 0!==e.metaData.answers[p].remove.yAns?m+e.metaData.answers[p].remove.yAns:e.metaData.answers[0].remove.y,width:e.metaData.answers[0].remove.width,height:e.metaData.answers[0].remove.height};null==c||c.drawImage(this.labelsImg,this.abcdLabelPos[g].left,this.abcdLabelPos[g].top,e.metaData.answers[0].remove.width,e.metaData.answers[0].remove.height,f.left,f.top,f.width,f.height),a[n].answerLabelsMockup["label-"+(t[0].alpha?t[0].alpha:t[0].key)]=f;for(let x=1;x<t.length;x++){let i=e.metaData.answers[x].x,r=e.metaData.answers[x].y;if(l+30<i){let t=[h,u];i<Math.max(...t)&&(i=Math.max(...t),i+s[x].width>o.width&&(i-=i+s[x].width-o.width),e.metaData.answers[x].remove.x=i),u+=s[x].width}else if(u=l+s[x].width,r+=b,b+=s[x].height-e.metaData.answers[x].height,r+s[x].height>o.height){let t=r+s[x].height-o.height;r-=t,e.metaData.answers[x].remove.y-=t}null==c||c.drawImage(s[x],i,r);let d=x,m=t[x].alpha?t[x].alpha:t[x].key;if(t[x].alpha){let e=t[x].key;for(let n=0;n<t.length;n++)if(e==t[n].alpha){d=n;break}}let g={left:void 0!==e.metaData.answers[d].remove.xAns?i+e.metaData.answers[d].remove.xAns:e.metaData.answers[x].remove.x,top:void 0!==e.metaData.answers[d].remove.yAns?r+e.metaData.answers[d].remove.yAns:e.metaData.answers[x].remove.y,width:e.metaData.answers[x].remove.width,height:e.metaData.answers[x].remove.height};if(null==c||c.drawImage(this.labelsImg,this.abcdLabelPos[m].left,this.abcdLabelPos[m].top,e.metaData.answers[x].remove.width,e.metaData.answers[x].remove.height,g.left,g.top,g.width,g.height),a[n].answerLabelsMockup["label-"+(t[x].alpha?t[x].alpha:t[x].key)]=g,x==t.length-1){a[n].mixDataImg=o.toDataURL("image/png");let t=document.getElementById("media_content_all_"+a[n].id);null==t||t.setAttribute("loadSuccess","1");let e=document.getElementById("questionPlaceholder_"+n);null==e||e.setAttribute("loadSuccess","1")}}}}return t.\u0275fac=function(e){return new(e||t)(a.Zb(o.a),a.Zb(c.a))},t.\u0275prov=a.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);